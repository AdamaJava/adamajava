package au.edu.qimr.tiledaligner;

import static org.junit.Assert.assertArrayEquals;
import static org.junit.Assert.assertEquals;

import au.edu.qimr.tiledaligner.model.TARecord;
import au.edu.qimr.tiledaligner.util.TiledAlignerUtil;

import java.util.Arrays;
import java.util.BitSet;
import java.util.HashMap;
import java.util.Map;
import java.util.Map.Entry;

import org.junit.Test;
import org.qcmg.common.util.NumberUtils;

import gnu.trove.list.TLongList;
import gnu.trove.list.array.TLongArrayList;

public class TARecordTest {
	
	@Test
	public void getNCount() {
		Map<Integer, TLongList> map = new HashMap<>();
		TARecord rec = new TARecord("ABC", map);
		assertArrayEquals (new int[] {}, rec.getTopNCounts(1,1));
		
		TLongList list = new TLongArrayList();
		list.add(100l);
		map.put(1,  list);
		rec = new TARecord("ABC", map);
		assertArrayEquals (new int[] {1}, rec.getTopNCounts(1,1));
		assertArrayEquals (new int[] {1}, rec.getTopNCounts(2,1));
		assertArrayEquals (new int[] {1}, rec.getTopNCounts(3,1));
		
		TLongList list2 = new TLongArrayList();
		list2.add(200l);
		map.put(2,  list2);
		rec = new TARecord("ABC", map);
		assertArrayEquals (new int[] {2}, rec.getTopNCounts(1,1));
		assertArrayEquals (new int[] {1,2}, rec.getTopNCounts(2,1));
		assertArrayEquals (new int[] {1,2}, rec.getTopNCounts(3,1));
		
		TLongList list3 = new TLongArrayList();
		list3.add(300l);
		map.put(3,  list3);
		rec = new TARecord("ABC", map);
		assertArrayEquals (new int[] {3}, rec.getTopNCounts(1,1));
		assertArrayEquals (new int[] {2,3}, rec.getTopNCounts(2,1));
		assertArrayEquals (new int[] {1,2,3}, rec.getTopNCounts(3,1));
	}
	
	@Test
	public void getLeaderBoard() {
		Map<String, TLongList> map = new HashMap<>();
		map.put("CTCCCTCCCCCTT", new TLongArrayList(new long[] {879061l, 2019707l, 2859101l, 3836754l, 3837052l, 6305080l, 6388988l, 28243215l, 29254156l, 30162757l, 38596251l, 41564418l, 44911182l, 55301918l, 76500408l, 85049615l, 151674811l, 157106709l, 158684652l, 165408586l, 168230579l, 187601278l, 198416753l, 206861903l, 207269239l, 230461527l, 233152101l, 245505214l, 255000936l, 259756366l, 265331196l, 267518578l, 272783448l, 275351641l, 281313215l, 282391773l, 282391840l, 288412213l, 288412278l, 288412297l, 288965701l, 304422980l, 304423010l, 309750206l, 315848255l, 323737499l, 346603482l, 374917904l, 383596499l, 395677111l, 408868975l, 410697724l, 411460690l, 422901143l, 425524617l, 436986460l, 447720516l, 455934648l, 469721791l, 470562099l, 483949620l, 483949805l, 486687273l, 487315425l, 487898614l, 497345587l, 498459249l, 525468144l, 538378347l, 542278373l, 547741946l, 550845781l, 553100158l, 554856892l, 556331859l, 563563336l, 566124456l, 574364216l, 580980086l, 608956093l, 612994856l, 618428951l, 636044587l, 638732655l, 647876723l, 651940301l, 661032091l, 670459526l, 679329464l, 691959820l, 697586849l, 744382935l, 745789080l, 747187814l, 766282058l, 768445695l, 777703691l, 780408910l, 817310066l, 821770918l, 825106104l, 831529482l, 844822946l, 845016820l, 849399747l, 859933540l, 862659755l, 862930394l, 878120288l, 913344347l, 919215319l, 939666078l, 957288819l, 963862413l, 976297620l, 976871201l, 1006192911l, 1021612362l, 1031936399l, 1039363787l, 1055374404l, 1055374534l, 1059461021l, 1060949644l, 1067773100l, 1072347420l, 1083823931l, 1094732693l, 1095525534l, 1095936332l, 1105816084l, 1107233157l, 1108434072l, 1109641446l, 1115606787l, 1119512351l, 1126920198l, 1153827012l, 1156194285l, 1162861632l, 1164926389l, 1171547958l, 1187340806l, 1199953393l, 1208210460l, 1209910785l, 1230031630l, 1232233006l, 1233734109l, 1244801407l, 1252844355l, 1259898382l, 1289783633l, 1290238625l, 1296665020l, 1300758829l, 1306945472l, 1311054135l, 1326302382l, 1334541861l, 1350231883l, 1350383119l, 1376842253l, 1388028925l, 1388028955l, 1401690151l, 1406908297l, 1408527065l, 1410004200l, 1412924916l, 1414442092l, 1425582639l, 1491802785l, 1510380237l, 1516786112l, 1524662833l, 1546363294l, 1548300922l, 1560252446l, 1562539236l, 1563768664l, 1566910342l, 1568116290l, 1568116334l, 1571622001l, 1574557039l, 1576446551l, 1578369359l, 1579712719l, 1619494168l, 1621062733l, 1634423851l, 1636425681l, 1669120266l, 1669642860l, 1671324732l, 1679844684l, 1680990572l, 1683812541l, 1700363847l, 1704420730l, 1714271783l, 1749065008l, 1755789055l, 1761261042l, 1769099968l, 1777210700l, 1781509889l, 1782786899l, 1784776746l, 1811305642l, 1817616141l, 1821236766l, 1823350719l, 1830655015l, 1831872541l, 1859510239l, 1874061289l, 1874848340l, 1876600550l, 1876744364l, 1881707111l, 1885876621l, 1902108742l, 1916937984l, 1920168407l, 1927272494l, 1934895471l, 1938339462l, 1953011451l, 1961214724l, 1963212868l, 1972929720l, 1978529661l, 1984331808l, 1996968883l, 2034617197l, 2064719014l, 2064829119l, 2073371922l, 2077380727l, 2103923284l, 2134283185l, 2168720992l, 2168721046l, 2180569043l, 2196939945l, 2221434853l, 2248069804l, 2254892369l, 2276429835l, 2276501229l, 2276941619l, 2277325304l, 2280142670l, 2286867300l, 2292959541l, 2296330251l, 2297556836l, 2300689917l, 2335409865l, 2345829897l, 2351774703l, 2353929972l, 2359389310l, 2381746430l, 2388115088l, 2391472372l, 2396056704l, 2419855386l, 2420429938l, 2426982874l, 2441141802l, 2456470368l, 2458553723l, 2458564994l, 2460070694l, 2469291801l, 2479675536l, 2481024676l, 2484584445l, 2484850581l, 2487295251l, 2489155268l, 2496722564l, 2502780789l, 2507962582l, 2513718358l, 2531197182l, 2531734125l, 2537954810l, 2546874483l, 2558865042l, 2570878974l, 2576535269l, 2577032313l, 2577938891l, 2578210871l, 2581269227l, 2590471778l, 2590473257l, 2616525460l, 2619018161l, 2628063616l, 2629402468l, 2634419328l, 2637901613l, 2643061598l, 2646372396l, 2660655815l, 2660934400l, 2661114332l, 2674035947l, 2675350342l, 2690350477l, 2690744812l, 2701362550l, 2710910718l, 2712904334l, 2728068679l, 2729012463l, 2734044145l, 2748676824l, 2750027861l, 2750829863l, 2757768765l, 2767227572l, 2770933976l, 2776564595l, 2780416687l, 2780871193l, 2796182266l, 2819037442l, 2847343287l, 2858936959l, 2864822622l, 2871995787l, 2873219285l, 2874961439l, 2876004070l, 2882365805l, 2890965597l, 2895134903l, 2896967929l, 2905184894l, 2924318438l, 2948411783l, 2949567612l, 2961922511l, 2968399034l, 2969721291l, 2980912165l, 3000672677l, 3004166569l, 3008933822l, 3016309484l, 3030667156l, 3033870071l, 3037586365l, 3039260215l, 3050537255l}));
		map.put("TCCCTCCCCCTTC", new TLongArrayList(new long[] {-9223372036854775130l}));
		map.put("CCCTCCCCCTTCT", new TLongArrayList(new long[] {2956006l, 10962749l, 17785216l, 19680922l, 19998768l, 23051516l, 25955240l, 29254158l, 44371063l, 44911184l, 88115284l, 108593696l, 112604919l, 117739934l, 151806922l, 152541097l, 155857748l, 156041861l, 156400746l, 171454803l, 174529856l, 218496945l, 219300424l, 222077231l, 230461529l, 233152103l, 253589800l, 280660789l, 280992652l, 288412196l, 288412261l, 288412280l, 296453417l, 304422952l, 304422982l, 304423012l, 327116087l, 352655819l, 363699691l, 373149232l, 376860645l, 386827627l, 410697648l, 417911599l, 420461746l, 429527675l, 458478510l, 466759352l, 466996163l, 469116048l, 489119077l, 490826834l, 515695156l, 521333180l, 550553006l, 553100160l, 595168835l, 608956095l, 612808046l, 622805885l, 637025462l, 670459528l, 677321481l, 689546743l, 691579421l, 692231933l, 697217666l, 701642360l, 706931781l, 717525020l, 765192106l, 766282060l, 768445697l, 819181994l, 829684768l, 829853586l, 829872609l, 831529484l, 835245642l, 848392771l, 859933542l, 864916402l, 889559932l, 937366899l, 954096987l, 959074544l, 963862415l, 970551394l, 974309252l, 976694549l, 1003887658l, 1006192913l, 1012993978l, 1018407550l, 1023270347l, 1036292428l, 1050900559l, 1054824883l, 1072347422l, 1074080912l, 1083602108l, 1101013045l, 1124871127l, 1131713543l, 1135121145l, 1162808352l, 1168577833l, 1171423952l, 1180284537l, 1186850885l, 1199953395l, 1219319418l, 1221926421l, 1225563744l, 1232088837l, 1238271113l, 1255100340l, 1279046539l, 1311054124l, 1331567289l, 1376514474l, 1400182448l, 1404158766l, 1414442094l, 1414728511l, 1415653529l, 1419192199l, 1421543704l, 1441033254l, 1444014301l, 1454354827l, 1461288109l, 1473218086l, 1510380239l, 1517992721l, 1523288196l, 1530839592l, 1548300924l, 1558398188l, 1563768666l, 1566910344l, 1571883583l, 1574091328l, 1606829239l, 1617062124l, 1637192951l, 1639906786l, 1647139070l, 1662562850l, 1664284811l, 1679844686l, 1681980733l, 1691782301l, 1709824133l, 1716364296l, 1718391372l, 1725754993l, 1745248876l, 1755789057l, 1765824756l, 1773461201l, 1775477305l, 1781509891l, 1783264288l, 1785804471l, 1795329159l, 1811305644l, 1818349239l, 1834722438l, 1853390677l, 1859510241l, 1881076999l, 1882279640l, 1885876623l, 1895957305l, 1910411654l, 1927076145l, 1961214726l, 1961282598l, 1963212870l, 2003637612l, 2007239206l, 2016657235l, 2040688597l, 2044265977l, 2046052977l, 2055315478l, 2064422763l, 2065758395l, 2113478933l, 2119753736l, 2152564797l, 2194176269l, 2221434855l, 2233605091l, 2248069806l, 2254676784l, 2256924274l, 2281750254l, 2292959543l, 2302184628l, 2303273751l, 2304766883l, 2304987581l, 2305610698l, 2336344663l, 2350012451l, 2353929974l, 2377677629l, 2381297454l, 2391472374l, 2396778572l, 2402534574l, 2411783441l, 2415851309l, 2424838796l, 2424838826l, 2428283481l, 2430993989l, 2431346940l, 2434230422l, 2439440210l, 2441500508l, 2458553725l, 2458564996l, 2472640954l, 2480325521l, 2481024678l, 2498877312l, 2499715310l, 2502853048l, 2503648437l, 2507962584l, 2531814860l, 2545528535l, 2558277708l, 2558849520l, 2560963967l, 2566721250l, 2567933404l, 2575970666l, 2577848813l, 2579180609l, 2579453226l, 2608651381l, 2616515948l, 2619061261l, 2621153400l, 2622862318l, 2632125629l, 2636113035l, 2654236930l, 2656191589l, 2658943472l, 2661114334l, 2661781418l, 2690350479l, 2690622202l, 2707728021l, 2710117064l, 2710279063l, 2710936836l, 2714874298l, 2728068681l, 2730340765l, 2750027863l, 2755235509l, 2757335808l, 2773923473l, 2805865887l, 2847343289l, 2885103648l, 2903045338l, 2908838279l, 2916984602l, 2921763523l, 2958819231l, 2959053267l, 2962072583l, 2962191356l, 2969861216l, 2985036408l, 2997603354l, 2998586425l, 3004166571l, 3010177975l, 3019778233l, 3023695460l, 3030689679l, 3039400872l, 3039576217l, 3050817534l, 3050914471l}));
		map.put("CCTCCCCCTTCTT", new TLongArrayList(new long[] {2956007l, 3708009l, 7112016l, 19122619l, 22432923l, 29254159l, 32950336l, 44877616l, 44911185l, 73856438l, 82385081l, 100992735l, 108593697l, 112604920l, 151806923l, 156041862l, 171454804l, 219300425l, 225623425l, 230262984l, 234017409l, 234946942l, 275654472l, 280660790l, 310660245l, 317285621l, 325829068l, 367141071l, 381553636l, 383603558l, 386827628l, 420461747l, 428279277l, 446135295l, 474814672l, 515695157l, 550553007l, 553100161l, 580749286l, 587340264l, 590079604l, 608956096l, 609584445l, 621362214l, 645961520l, 682247506l, 682490661l, 693833479l, 697217667l, 703680468l, 705333202l, 706858781l, 706931782l, 717156846l, 718888555l, 722849311l, 735633377l, 812768956l, 823941065l, 864916403l, 883945918l, 889559933l, 891978129l, 913285342l, 917507145l, 937366900l, 948132488l, 996365399l, 1006192914l, 1012993979l, 1036292429l, 1046074478l, 1064365830l, 1081861493l, 1113332203l, 1135121146l, 1148725174l, 1162808353l, 1186850886l, 1221926422l, 1232088838l, 1238901448l, 1262790113l, 1265369600l, 1279046540l, 1306594069l, 1307378410l, 1392167283l, 1414728512l, 1430012778l, 1441033255l, 1453885932l, 1510380240l, 1511577583l, 1517992722l, 1528522567l, 1537219727l, 1574091329l, 1606829240l, 1637192952l, 1639906787l, 1647139071l, 1648051966l, 1648095300l, 1651089303l, 1652731647l, 1658360398l, 1679844687l, 1727501971l, 1764394863l, 1781509892l, 1795329160l, 1813657561l, 1852071519l, 1874266384l, 1874293682l, 1882279641l, 1895957306l, 1910411655l, 1959681570l, 1967970368l, 1994496313l, 2003637613l, 2007239207l, 2036627598l, 2050658348l, 2070584248l, 2074333914l, 2080422302l, 2127550150l, 2138306146l, 2233605092l, 2296460899l, 2302184629l, 2349687840l, 2350012452l, 2370384224l, 2380959482l, 2381782118l, 2385779698l, 2386016342l, 2401820609l, 2414503350l, 2415851310l, 2426692465l, 2436223357l, 2440314375l, 2458553726l, 2458564997l, 2487085817l, 2498877313l, 2500620318l, 2502853049l, 2503648438l, 2533872701l, 2546763185l, 2554143135l, 2567933405l, 2642758437l, 2703717395l, 2706555756l, 2710279064l, 2722789396l, 2735880957l, 2750027864l, 2757335809l, 2815781267l, 2820846524l, 2863346621l, 2870452282l, 2881445647l, 2898734062l, 2908838280l, 2916984603l, 2918805599l, 2921877268l, 2955101075l, 2957339912l, 2959053268l, 3010177976l, 3012812378l, 3020963013l, 3036666207l}));
		map.put("CTCCCCCTTCTTT", new TLongArrayList(new long[] {3708010l, 29254160l, 32950337l, 40107358l, 44877617l, 44911186l, 44973554l, 86627755l, 88061418l, 108593698l, 114784490l, 150605718l, 153703261l, 155599469l, 156738306l, 156816159l, 159774107l, 164662765l, 171454805l, 182158710l, 207811456l, 219300426l, 225623426l, 267864202l, 293274747l, 293592155l, 304761288l, 379973164l, 380713853l, 381553637l, 382679755l, 386827629l, 415294110l, 420461748l, 470240050l, 481242408l, 482501422l, 495539712l, 498603214l, 502342366l, 519919429l, 538791056l, 590079605l, 605196123l, 614853471l, 621362215l, 645961521l, 674711752l, 677733342l, 680847914l, 681982862l, 682490662l, 693833480l, 706858782l, 718888556l, 728169991l, 747174016l, 812637823l, 823941066l, 839336205l, 842581562l, 843667645l, 864916404l, 869341488l, 869534631l, 892530898l, 912116756l, 913285343l, 923138078l, 927629852l, 937366901l, 948263266l, 994050633l, 996365400l, 1017376709l, 1037714429l, 1046074479l, 1055216410l, 1061449232l, 1064365831l, 1101027401l, 1104816003l, 1140971915l, 1142143529l, 1171423583l, 1185393128l, 1196259109l, 1238282388l, 1238290892l, 1282039120l, 1306642629l, 1338002984l, 1390923305l, 1399399152l, 1400154391l, 1412619219l, 1420085446l, 1425898381l, 1450747292l, 1494899884l, 1511577584l, 1516712309l, 1517992723l, 1574091330l, 1641815329l, 1674009987l, 1679844688l, 1687242586l, 1690213614l, 1714470063l, 1740686627l, 1764394864l, 1795329161l, 1817926668l, 1818028443l, 1847607451l, 1874266385l, 1874293683l, 1895957307l, 1908935191l, 1910411656l, 1934502620l, 1934675781l, 1940478700l, 1967970369l, 1982326913l, 2009638949l, 2022084982l, 2050658349l, 2080422303l, 2107107666l, 2138306147l, 2159870748l, 2219330463l, 2296460900l, 2302614507l, 2350012453l, 2367748930l, 2370384225l, 2381843055l, 2390628772l, 2458553727l, 2458564998l, 2477730405l, 2527497397l, 2550645988l, 2554143136l, 2564436853l, 2582004519l, 2601032332l, 2608852833l, 2616052019l, 2680713921l, 2687576151l, 2690366284l, 2695510006l, 2697045156l, 2701353838l, 2722789397l, 2750217238l, 2757335810l, 2801534781l, 2815781268l, 2870452283l, 2881445648l, 2921759074l, 2921877269l, 2971856901l, 2994345715l, 3020963014l, 3036666208l, 3040981750l}));
		map.put("TCCCCCTTCTTTC", new TLongArrayList(new long[] {3708011l, 9007316l, 15607756l, 17541863l, 20287502l, 29254161l, 32950338l, 48022181l, 52047113l, 88061419l, 94982589l, 102436064l, 114784491l, 156739710l, 156816160l, 164662766l, 167965427l, 171454806l, 182158711l, 200112562l, 235693466l, 263203716l, 268807892l, 305656168l, 315208483l, 339176069l, 348493054l, 359769826l, 366007383l, 382679756l, 420461749l, 428333965l, 446907434l, 468118978l, 486461282l, 498603215l, 511336918l, 516839879l, 519919430l, 521740779l, 573600414l, 620568912l, 646230702l, 678700268l, 681982863l, 682490663l, 693833481l, 706425030l, 706858783l, 715889493l, 718888557l, 728169992l, 760219824l, 760332861l, 765095406l, 771032561l, 776713168l, 802012943l, 839336206l, 842581563l, 845307317l, 864916405l, 892530899l, 936136724l, 984678888l, 1022714637l, 1026457879l, 1046074480l, 1059990166l, 1067008980l, 1088693569l, 1101027402l, 1133032170l, 1142143530l, 1154879094l, 1160352283l, 1165025921l, 1171423584l, 1182756801l, 1185393129l, 1271305376l, 1276221263l, 1278539366l, 1305865367l, 1306642630l, 1320978071l, 1372489594l, 1399399153l, 1413948811l, 1425898382l, 1450747293l, 1470055485l, 1472834528l, 1483085628l, 1501920981l, 1509777114l, 1511577585l, 1517992724l, 1522608701l, 1533881459l, 1543238417l, 1549016479l, 1555768104l, 1560133801l, 1560133993l, 1560134185l, 1560134377l, 1574091331l, 1621376305l, 1625240085l, 1633371467l, 1662503976l, 1663249524l, 1669059665l, 1670254424l, 1674009988l, 1685178369l, 1692777154l, 1714470064l, 1753926606l, 1764394865l, 1778593512l, 1784328774l, 1817926669l, 1818028444l, 1820014240l, 1847607452l, 1860841400l, 1863856060l, 1880902940l, 1895957308l, 1924612426l, 1940478701l, 1954911693l, 1963986228l, 1978130730l, 1994107670l, 1995007366l, 1995013975l, 2003385609l, 2041218536l, 2050658350l, 2082065104l, 2107107667l, 2138306148l, 2146756583l, 2225579942l, 2250091428l, 2264360714l, 2298318327l, 2341209842l, 2344593924l, 2370384226l, 2381843056l, 2400354824l, 2415285778l, 2420406506l, 2458553728l, 2458564999l, 2461936002l, 2469819604l, 2479775654l, 2491325044l, 2527497398l, 2534165404l, 2545221535l, 2554143137l, 2567933567l, 2582416100l, 2616052020l, 2621083514l, 2624843546l, 2641881520l, 2650038607l, 2650286892l, 2656635481l, 2690366285l, 2702741460l, 2722789398l, 2730117406l, 2748637501l, 2752524084l, 2754367483l, 2763876240l, 2820272292l, 2876204307l, 2884379000l, 2962373796l, 2962717625l, 2966531132l, 2968085740l, 2988464494l, 2998434273l, 3002461167l, 3021636519l, 3032311803l, 3059119149l}));
		map.put("CCCCCTTCTTTCT", new TLongArrayList(new long[] {3708012l, 10952796l, 15607757l, 16436389l, 20287503l, 32950339l, 36172258l, 38982091l, 48022182l, 59689197l, 92627547l, 114784492l, 154862088l, 156816161l, 167965428l, 172056453l, 212355275l, 235693467l, 245344504l, 263203717l, 267010981l, 268807893l, 277894450l, 305656169l, 306789735l, 312012406l, 315208484l, 339176070l, 348493055l, 359769827l, 362059153l, 366007384l, 396704303l, 428333966l, 442608092l, 468118979l, 508858118l, 520641201l, 521740780l, 538582522l, 548406555l, 563524016l, 573600415l, 599667807l, 620568913l, 646230703l, 676040592l, 681982864l, 699024748l, 706858784l, 715889494l, 718888558l, 728169993l, 738643597l, 745883229l, 760219825l, 760332862l, 776713169l, 791229910l, 814733142l, 842581564l, 864916406l, 914154496l, 936136725l, 943982938l, 945981058l, 1026006323l, 1026457880l, 1049824122l, 1059990167l, 1067008981l, 1071119266l, 1101027403l, 1104617462l, 1113075145l, 1133032171l, 1154879095l, 1162334258l, 1171423585l, 1182756802l, 1185393130l, 1256262433l, 1271426787l, 1276221264l, 1320978072l, 1323949504l, 1364607154l, 1365997200l, 1374782496l, 1389374312l, 1399399154l, 1413948812l, 1467897133l, 1480838879l, 1483085629l, 1489223951l, 1489981993l, 1501919929l, 1507366940l, 1511577586l, 1520955176l, 1549016480l, 1555768105l, 1563643544l, 1611758732l, 1629473871l, 1633371468l, 1659374130l, 1662503977l, 1663664931l, 1668019300l, 1668708186l, 1670254425l, 1692777155l, 1705558023l, 1707614020l, 1714470065l, 1753926607l, 1764394866l, 1820014241l, 1849975823l, 1850595927l, 1860841401l, 1924612427l, 1932283463l, 1950174831l, 1954911694l, 1955050643l, 1959607321l, 1960854085l, 1963986229l, 1978130731l, 1994107671l, 1995007367l, 1995013976l, 2003385610l, 2017385996l, 2045459448l, 2050658351l, 2064147694l, 2082065105l, 2138306149l, 2138980234l, 2160920022l, 2181968846l, 2227166354l, 2252243702l, 2276452218l, 2370384227l, 2375593061l, 2382794240l, 2396562794l, 2418773884l, 2439942378l, 2458553729l, 2458565000l, 2469819605l, 2491325045l, 2514722808l, 2532208838l, 2534165405l, 2545221536l, 2554143138l, 2582416101l, 2616052021l, 2616397466l, 2624843547l, 2641881521l, 2642071849l, 2650038608l, 2650286893l, 2656635482l, 2661165261l, 2673037965l, 2698982384l, 2711801349l, 2714347694l, 2722789399l, 2752524085l, 2779052787l, 2821815597l, 2862905706l, 2870680160l, 2876204308l, 2882912353l, 2884379001l, 2904242778l, 2962717626l, 2966531133l, 2998434274l, 3002461168l, 3010602165l, 3021636520l, 3038132913l, 3059119150l}));
		map.put("CCCCTTCTTTCTT", new TLongArrayList(new long[] {3059988l, 10952797l, 15607758l, 20287504l, 36172259l, 38701411l, 49099510l, 59689198l, 59918423l, 60930288l, 63533303l, 68722643l, 92627548l, 114784493l, 114791663l, 116660483l, 119822714l, 154862089l, 156149872l, 167965429l, 170506198l, 197780276l, 200422203l, 204255975l, 212355276l, 218727551l, 238728032l, 245344505l, 253253295l, 263160814l, 267010982l, 269571806l, 270389279l, 277086637l, 287392283l, 291109409l, 303921671l, 305643639l, 305656170l, 322884244l, 339176071l, 362059154l, 365680815l, 367856790l, 377595746l, 378691402l, 387364497l, 389675386l, 390554454l, 396704304l, 399867957l, 412535479l, 422418560l, 428333967l, 429077934l, 433514430l, 434643569l, 435429255l, 456937955l, 458474956l, 459944061l, 464050807l, 468118980l, 477579973l, 488040394l, 503880194l, 506008694l, 506497369l, 508858119l, 513286932l, 523794918l, 530174748l, 538582523l, 548406556l, 552875581l, 561197622l, 563524017l, 574894143l, 590542956l, 594508295l, 599667808l, 613149951l, 618429743l, 635300320l, 640721668l, 646230704l, 649560656l, 651033439l, 656676266l, 658537743l, 670841664l, 681704323l, 682265339l, 683502494l, 683645289l, 698400883l, 699024749l, 700838234l, 715889495l, 718888559l, 749342474l, 779828778l, 797140529l, 829074580l, 834849584l, 839425676l, 849224797l, 851010284l, 872743429l, 885990112l, 885990160l, 890187665l, 892539132l, 902723132l, 904147782l, 908806597l, 914154497l, 936136726l, 943673180l, 945981059l, 948734341l, 959738436l, 963155182l, 990484302l, 1016023682l, 1026006324l, 1028912598l, 1035624529l, 1049121321l, 1049824123l, 1066975460l, 1071119267l, 1081108490l, 1091839054l, 1107073334l, 1109627892l, 1115319296l, 1125695726l, 1133032172l, 1145365985l, 1146562731l, 1154879096l, 1162808312l, 1165638442l, 1170187761l, 1170823586l, 1190525838l, 1192197869l, 1192957339l, 1218228516l, 1221537651l, 1240807782l, 1249990605l, 1267000169l, 1287016360l, 1306509394l, 1323949505l, 1324524261l, 1325304131l, 1325675790l, 1336450224l, 1336760857l, 1342100723l, 1346692040l, 1351626853l, 1357184879l, 1360410016l, 1364607155l, 1374782497l, 1387212251l, 1399350879l, 1399399155l, 1413948813l, 1418600897l, 1419288884l, 1421338573l, 1434968862l, 1467897134l, 1489223952l, 1489981994l, 1498359713l, 1502067180l, 1512537702l, 1518375553l, 1520955177l, 1521740594l, 1525393848l, 1531506663l, 1535512837l, 1538391226l, 1549016481l, 1552692196l, 1555768106l, 1583009094l, 1604750654l, 1614686690l, 1626504730l, 1641062946l, 1647889259l, 1659374131l, 1663664932l, 1668708187l, 1669848202l, 1672172109l, 1681225340l, 1684488832l, 1687645246l, 1691862639l, 1692777156l, 1694781323l, 1705558024l, 1707556400l, 1740462099l, 1771388965l, 1776381043l, 1785818825l, 1787412247l, 1802950737l, 1804229502l, 1809198057l, 1824925682l, 1825106223l, 1829471149l, 1829909776l, 1831662025l, 1849975824l, 1853570493l, 1861625641l, 1876691896l, 1876774146l, 1885205869l, 1885306877l, 1899291107l, 1905256383l, 1905761605l, 1919249880l, 1922169353l, 1926858470l, 1935052304l, 1944427413l, 1948472415l, 1949075809l, 1953276319l, 1959607322l, 1960854086l, 1971032284l, 1977121063l, 1978130732l, 1991822574l, 1992464167l, 1995007368l, 1995013977l, 1999411184l, 2005334103l, 2006399827l, 2019274450l, 2020242578l, 2022361928l, 2051778481l, 2061102714l, 2061923107l, 2071933241l, 2073907170l, 2076196550l, 2076276425l, 2110045414l, 2118278734l, 2154308109l, 2160920023l, 2221449057l, 2234826987l, 2239985918l, 2252027402l, 2252243703l, 2291676071l, 2296091936l, 2297457784l, 2297924997l, 2329681729l, 2333845249l, 2340861986l, 2343870069l, 2344342599l, 2374516555l, 2375593062l, 2396013586l, 2397266140l, 2415373851l, 2433069625l, 2462212080l, 2477165193l, 2483274039l, 2489833991l, 2495198700l, 2508532335l, 2514722809l, 2531508210l, 2532208839l, 2545141901l, 2546305282l, 2547349037l, 2550364427l, 2550833223l, 2579594739l, 2581111348l, 2600854462l, 2607269483l, 2610420266l, 2624843548l, 2642071850l, 2643808912l, 2650038609l, 2650334009l, 2656635483l, 2661311232l, 2669827534l, 2669827839l, 2671070586l, 2674551617l, 2676481746l, 2688217304l, 2694841601l, 2700891506l, 2700959429l, 2705190999l, 2706073993l, 2711801350l, 2712165801l, 2717018437l, 2723104231l, 2725189223l, 2727102359l, 2727855729l, 2734186874l, 2752337071l, 2752524086l, 2764604913l, 2770326744l, 2775036776l, 2779052788l, 2812293470l, 2816218812l, 2823362659l, 2862905707l, 2885179106l, 2899571476l, 2901016590l, 2901676849l, 2920220897l, 2935770522l, 2935935029l, 2943662614l, 2955445902l, 3004699807l, 3006949406l, 3008789988l, 3014429832l, 3016630753l, 3017671447l, 3021636521l, 3028869582l, 3031924558l}));
		map.put("CCCTTCTTTCTTC", new TLongArrayList(new long[] {3059989l, 9041382l, 24654205l, 27165843l, 35741879l, 49099511l, 49289769l, 50985448l, 59918424l, 62996092l, 78642808l, 89099199l, 91177482l, 92823773l, 114791664l, 116869111l, 152040279l, 156857051l, 157940255l, 162884843l, 164899796l, 166815201l, 180798903l, 205218873l, 208917231l, 218727552l, 221550848l, 225746211l, 232435554l, 245400448l, 255418496l, 258544968l, 262327520l, 263160815l, 269571807l, 278910714l, 290622683l, 291199811l, 319379983l, 323858694l, 325163233l, 332707537l, 367856791l, 379147105l, 385596443l, 386827958l, 388996706l, 390121703l, 392608669l, 402747909l, 411974887l, 412997051l, 429858354l, 430906052l, 436659582l, 441686711l, 450117727l, 458163547l, 458474957l, 458743707l, 462455591l, 464050808l, 467833671l, 476778692l, 486990691l, 500799761l, 506008695l, 506497370l, 508858120l, 516893971l, 530174749l, 538582524l, 545488250l, 552174209l, 558144477l, 563035151l, 599170405l, 601607904l, 606659389l, 617458904l, 618429744l, 619988379l, 628210705l, 642649163l, 642920837l, 649351602l, 656676267l, 672557848l, 676311863l, 698975859l, 705071634l, 713185851l, 718888560l, 725549769l, 747067395l, 779828779l, 797140530l, 801265129l, 829074581l, 835268802l, 835389593l, 835492861l, 846422321l, 847776949l, 848227614l, 857444853l, 864928311l, 872743430l, 879554485l, 885990113l, 898114678l, 909994802l, 913037188l, 914154498l, 923008721l, 932926441l, 936136727l, 942951668l, 948734342l, 965000293l, 975242054l, 976159549l, 979543844l, 990484303l, 996513333l, 1000533668l, 1000584699l, 1005042698l, 1024646096l, 1026006325l, 1030790388l, 1034774502l, 1049824124l, 1071146067l, 1076369427l, 1076640524l, 1081108491l, 1081773917l, 1082432968l, 1095872846l, 1099786248l, 1103512821l, 1125695727l, 1135397953l, 1137119041l, 1141080806l, 1146049414l, 1157345969l, 1165638443l, 1170187762l, 1188007248l, 1193772535l, 1201825707l, 1214682183l, 1217719233l, 1221200569l, 1221833745l, 1231217678l, 1234899923l, 1237438823l, 1237994929l, 1244729974l, 1261028271l, 1264120432l, 1264931896l, 1266802000l, 1275483191l, 1276829365l, 1279424905l, 1280151286l, 1283209901l, 1290238864l, 1290238941l, 1306509395l, 1331306126l, 1341938775l, 1342100724l, 1356267123l, 1361075095l, 1374782498l, 1387212252l, 1388723623l, 1391601400l, 1393315116l, 1396959993l, 1399399156l, 1399512643l, 1414700765l, 1419288885l, 1420057079l, 1420528349l, 1421338574l, 1430063118l, 1434968863l, 1454344087l, 1467897135l, 1468547711l, 1485651574l, 1488771468l, 1489223953l, 1489417307l, 1489981995l, 1491472642l, 1498359714l, 1502067181l, 1506744081l, 1512537703l, 1522254053l, 1522543141l, 1525393849l, 1526870120l, 1539225895l, 1543760939l, 1546822778l, 1547193829l, 1550855793l, 1557064405l, 1569197502l, 1607962213l, 1608300307l, 1613100326l, 1614686691l, 1615010946l, 1629358474l, 1641062947l, 1656860433l, 1658390529l, 1658497055l, 1659374132l, 1659534993l, 1662332993l, 1663664933l, 1669848203l, 1673031121l, 1691536564l, 1693686605l, 1695866633l, 1696177462l, 1696872226l, 1740462100l, 1753980626l, 1754732581l, 1771388966l, 1773062999l, 1776381044l, 1780030312l, 1783457653l, 1791057910l, 1804229503l, 1807616590l, 1808978446l, 1821369132l, 1821648439l, 1823549493l, 1824925683l, 1825771792l, 1843123649l, 1846638662l, 1857712826l, 1859125219l, 1861625642l, 1874809525l, 1875614524l, 1878270905l, 1882164683l, 1882591222l, 1892493754l, 1914980019l, 1918160479l, 1918865161l, 1922162547l, 1930949702l, 1941948021l, 1942253671l, 1948472416l, 1949075810l, 1960854087l, 1966067661l, 1966300430l, 1969816565l, 1977121064l, 1978130733l, 1999411185l, 2005203404l, 2005334104l, 2005976364l, 2011730432l, 2016434956l, 2019274451l, 2021597267l, 2022361929l, 2024686958l, 2032674257l, 2040065411l, 2043588585l, 2048747442l, 2050283093l, 2054281807l, 2061102715l, 2069183641l, 2071933242l, 2074770652l, 2110045415l, 2122644389l, 2132302631l, 2139401479l, 2156548454l, 2160920024l, 2221449058l, 2235087421l, 2235563558l, 2252027403l, 2272226263l, 2279729603l, 2297457785l, 2298969567l, 2299069822l, 2329227371l, 2330531114l, 2340151513l, 2344756448l, 2348656599l, 2359567448l, 2360827077l, 2377073165l, 2382938441l, 2386119587l, 2387443966l, 2410689161l, 2415877188l, 2423907446l, 2427689400l, 2443304050l, 2444269683l, 2462251107l, 2477165194l, 2490853702l, 2495198701l, 2504533604l, 2507635441l, 2512535787l, 2531508211l, 2535167646l, 2539594657l, 2542501879l, 2545009036l, 2547644710l, 2558998948l, 2559307080l, 2564770956l, 2572586453l, 2593499501l, 2601410140l, 2606718411l, 2610420267l, 2624843549l, 2626164344l, 2644747394l, 2650334010l, 2654082532l, 2654409997l, 2661311233l, 2663657679l, 2666595193l, 2671323191l, 2672166512l, 2680910085l, 2688217305l, 2694841602l, 2720685833l, 2721023760l, 2726042189l, 2727005762l, 2734186875l, 2743640294l, 2754679420l, 2756883912l, 2760148666l, 2764620768l, 2775138135l, 2775733184l, 2777786795l, 2803493531l, 2813489939l, 2823362660l, 2856324869l, 2878240107l, 2881516792l, 2884368098l, 2887233994l, 2888156060l, 2899023640l, 2935770523l, 2947918696l, 2955445903l, 2974852899l, 2988350984l, 3008789989l, 3015898203l, 3015898239l, 3015915478l, 3015915514l, 3017671448l, 3021636522l, 3028690408l, 3030353523l, 3033168647l, 3036737352l, 3043336289l, 3062222673l, 3064055018l, 3100147715l}));
		map.put("CCTTCTTTCTTCC", new TLongArrayList(new long[] {-9223372036854775129l}));
		map.put("CTTCTTTCTTCCT", new TLongArrayList(new long[] {-9223372036854774720l}));
		map.put("TTCTTTCTTCCTC", new TLongArrayList(new long[] {-9223372036854774692l}));
		map.put("TCTTTCTTCCTCC", new TLongArrayList(new long[] {-9223372036854775058l}));
		map.put("CTTTCTTCCTCCT", new TLongArrayList(new long[] {-9223372036854775030l}));
		map.put("TTTCTTCCTCCTT", new TLongArrayList(new long[] {-9223372036854774949l}));
		map.put("TTCTTCCTCCTTC", new TLongArrayList(new long[] {-9223372036854774980l}));
		map.put("TCTTCCTCCTTCC", new TLongArrayList(new long[] {-9223372036854774942l}));
		map.put("CTTCCTCCTTCCC", new TLongArrayList(new long[] {-9223372036854774685l}));
		map.put("TTCCTCCTTCCCT", new TLongArrayList(new long[] {-9223372036854774613l}));
		map.put("TCCTCCTTCCCTC", new TLongArrayList(new long[] {-9223372036854774751l}));
		map.put("CCTCCTTCCCTCC", new TLongArrayList(new long[] {-9223372036854773422l}));
		map.put("CTCCTTCCCTCCT", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("TCCTTCCCTCCTT", new TLongArrayList(new long[] {-9223372036854773468l}));
		map.put("CCTTCCCTCCTTC", new TLongArrayList(new long[] {-9223372036854773544l}));
	
		
		Map<Integer, TLongList> map2 = TiledAlignerUtil.getTiles(map, "CTCCCTCCCCCTTCTTTCTTCCTCCTTCCCTCCTTC", 13, false);
		for (Entry<Integer, TLongList> entry : map2.entrySet()) {
			System.out.println("entry getKey: " + Arrays.toString(NumberUtils.splitIntInto2(entry.getKey())) + ", list size: " + entry.getValue().size());
		}
		assertArrayEquals(new long[] {2458553723l, 2458564994l}, map2.get(NumberUtils.pack2IntsInto1(7, 0)).toArray());
		assertArrayEquals(new long[] {29254156l, 3299253771883l}, map2.get(NumberUtils.pack2IntsInto1(6, 0)).toArray());
	}
	
	@Test
	public void getCountWithLotsOfCommonTiles() {
		Map<String, TLongList> map = new HashMap<>();
		map.put("GACAGATCACGAG",new TLongArrayList(new long[] {1240342426l}));
		map.put("ACAGATCACGAGG",new TLongArrayList(new long[] {1240342427l}));
		//common tiles
		map.put("CAGATCACGAGGT", new TLongArrayList(new long[] {-9223372036854775129l}));
		map.put("AGATCACGAGGTC", new TLongArrayList(new long[] {-9223372036854775129l}));
		map.put("GATCACGAGGTCA", new TLongArrayList(new long[] {-9223372036854775129l}));
		map.put("ATCACGAGGTCAG", new TLongArrayList(new long[] {-9223372036854775129l}));
		map.put("TCACGAGGTCAGG", new TLongArrayList(new long[] {-9223372036854775129l}));
		map.put("CACGAGGTCAGGA", new TLongArrayList(new long[] {-9223372036854775129l}));
		map.put("ACGAGGTCAGGAG", new TLongArrayList(new long[] {-9223372036854775129l}));
		map.put("CGAGGTCAGGAGT", new TLongArrayList(new long[] {-9223372036854775129l}));
		map.put("GAGGTCAGGAGTT", new TLongArrayList(new long[] {-9223372036854775129l}));
		map.put("AGGTCAGGAGTTC", new TLongArrayList(new long[] {-9223372036854775129l}));
		map.put("GGTCAGGAGTTCA", new TLongArrayList(new long[] {-9223372036854775129l}));
		map.put("GTCAGGAGTTCAA", new TLongArrayList(new long[] {-9223372036854775129l}));
		map.put("TCAGGAGTTCAAG", new TLongArrayList(new long[] {-9223372036854775129l}));
		map.put("CAGGAGTTCAAGA", new TLongArrayList(new long[] {-9223372036854775129l}));
		map.put("AGGAGTTCAAGAC", new TLongArrayList(new long[] {-9223372036854775129l}));
		map.put("GGAGTTCAAGACC", new TLongArrayList(new long[] {-9223372036854775129l}));
		map.put("GAGTTCAAGACCA", new TLongArrayList(new long[] {-9223372036854775129l}));
		map.put("AGTTCAAGACCAG", new TLongArrayList(new long[] {-9223372036854775129l}));
		// end of common tiles
		map.put("GTTCAAGACCAGT",new TLongArrayList(new long[] {1240342446l}));
		map.put("TTCAAGACCAGTC", new TLongArrayList(new long[] {1240342447l}));
		map.put("TCAAGACCAGTCT", new TLongArrayList(new long[] {1240342448l}));
		map.put("CAAGACCAGTCTA", new TLongArrayList(new long[] {1240342449l}));
		map.put("AAGACCAGTCTAG", new TLongArrayList(new long[] {1240342450l}));
		map.put("AGACCAGTCTAGG", new TLongArrayList(new long[] {1240342451l}));
		map.put("GACCAGTCTAGGC", new TLongArrayList(new long[] {1240342452l}));
		map.put("ACCAGTCTAGGCA", new TLongArrayList(new long[] {1240342453l}));
		map.put("CCAGTCTAGGCAA", new TLongArrayList(new long[] {1240342454l}));
		map.put("CAGTCTAGGCAAT", new TLongArrayList(new long[] {1240342455l}));
		map.put("AGTCTAGGCAATA", new TLongArrayList(new long[] {1240342456l}));
		map.put("GTCTAGGCAATAT", new TLongArrayList(new long[] {1240342457l}));
		map.put("TCTAGGCAATATG", new TLongArrayList(new long[] {1240342458l}));
		map.put("CTAGGCAATATGG", new TLongArrayList(new long[] {1240342459l}));
		map.put("TAGGCAATATGGT", new TLongArrayList(new long[] {1240342460l}));
		map.put("AGGCAATATGGTG", new TLongArrayList(new long[] {1240342461l}));
		map.put("GGCAATATGGTGA", new TLongArrayList(new long[] {1240342462l}));
		map.put("GCAATATGGTGAA", new TLongArrayList(new long[] {1240342463l}));
		// back to common
		map.put("CAATATGGTGAAA", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("AATATGGTGAAAC", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("ATATGGTGAAACC", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("TATGGTGAAACCC", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("ATGGTGAAACCCC", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("TGGTGAAACCCCA", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("GGTGAAACCCCAT", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("GTGAAACCCCATC", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("TGAAACCCCATCT", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("GAAACCCCATCTC", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("AAACCCCATCTCT", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("AACCCCATCTCTA", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("ACCCCATCTCTAC", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("CCCCATCTCTACT", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("CCCATCTCTACTA", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("CCATCTCTACTAA", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("CATCTCTACTAAA", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("ATCTCTACTAAAA", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("TCTCTACTAAAAA", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("CTCTACTAAAAAT", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("TCTACTAAAAATA", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("CTACTAAAAATAC", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("TACTAAAAATACA", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("ACTAAAAATACAA", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("CTAAAAATACAAA", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("TAAAAATACAAAA", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("AAAAATACAAAAA", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("AAAATACAAAAAT", new TLongArrayList(new long[] {-9223372036854774540l}));
		map.put("AAATACAAAAATT", new TLongArrayList(new long[] {-9223372036854774540l}));
		
		Map<Integer, TLongList> map2 = TiledAlignerUtil.getTiles(map, "GACAGATCACGAGGTCAGGAGTTCAAGACCAGTCTAGGCAATATGGTGAAACCCCATCTCTACTAAAAATACAAAAATT", 13, false);
		for (Entry<Integer, TLongList> entry : map2.entrySet()) {
			System.out.println("entry getKey: " + Arrays.toString(NumberUtils.splitIntInto2(entry.getKey())) + ", list size: " + entry.getValue().size());
		}
		assertEquals(1, map2.size());
		assertEquals(true, map2.containsKey(NumberUtils.pack2IntsInto1(67, 0)));
	}
	
	@Test
	public void getLeaderBoardRealLife() {
		Map<Integer, TLongList> map = new HashMap<>();
		TLongList list1 = new TLongArrayList();
		list1.addAll(new long[] {2704891429l, 1633013531l});
		map.put(7,  list1);
		TLongList list2 = new TLongArrayList();
		list2.addAll(new long[] {2043963461});
		map.put(6,  list2);
		TLongList list3 = new TLongArrayList();
		list3.addAll(new long[] {30225391, 1329589745, 162005290, 1029457734, 1368186023, 4611686019418340890l, 4611686019136627171l, 4611686020222936906l});
		map.put(5,  list3);
		TARecord taRec = new TARecord("GAAAGGAGAAACAGTCCTGGATCAACGACACCC", map);
		
		assertEquals(1, taRec.getLeaderBoardPositionOfPosition(1633013527));
	}
	
	@Test
	public void getLeaderBoardRealLife2() {
		Map<Integer, TLongList> map = new HashMap<>();
		TLongList list1 = new TLongArrayList();
		list1.addAll(new long[] {4611686019477361893l, 4611686018743142099l, 4611686020305128832l});
		map.put(12,  list1);
		TLongList list2 = new TLongArrayList();
		list2.addAll(new long[] {4611686020157201868l, 4611686020657069100l, 4611686021296871881l, 4611686018944322524l, 4611686019872817302l, 4611686020700627144l, 4611686020461786907l});
		map.put(11,  list2);
		TARecord taRec = new TARecord("GGNCNANAGTNTTNNCGTTTTGCCCAGTCTGGAGTGCTGGTGTGAGATTGCGGGGCGGTACAAGCTTGCACTCCCGAGTTACAACCTGTCCCCTTGCTCCAGCTCGCTAAAAAG", map);
		
		assertEquals(1, taRec.getLeaderBoardPositionOfPosition(4611686020305129280l));
	}
	
	@Test
	public void getLeaderBoardRealLife3() {
		Map<Integer, TLongList> map = new HashMap<>();
		TLongList list1 = new TLongArrayList();
		list1.addAll(new long[] {4611686019140440870l, 4611686020684395383l, 4611686020056145457l, 4611686021141921632l, 4611686019463589388l, 4611686021041643463l, 4611686018539247848l });
		map.put(21,  list1);
		TLongList list2 = new TLongArrayList();
		list2.addAll(new long[] {4611686020767675386l, 461168601953248998l,4611686019326755734l,4611686019878644166l,4611686021340962004l,4611686019113200410l,4611686019370098987l,4611686018484460973l,4611686018706506142l,4611686019087503369l,4611686019575390671l,4611686020389817779l,4611686018534616340l,4611686018627289373l,4611686018745388501l,4611686019042055200l,4611686019225052092l,4611686019297472537l,4611686019297747653l,4611686019438213775l,4611686019786818056l,4611686019986795250l,4611686020132056375l,4611686020173457461l,4611686020284936351l,4611686020340014875l,4611686020419371017l,4611686020425161014l,4611686020728548345l,4611686020914877994l,4611686020962675367l,4611686021153322548l,4611686021167836036l,4611686021345062236l,4611686019273935810l,4611686018815515401l,4611686019083532486l,4611686020042873996l,4611686021350228518l});
		map.put(20,  list2);
		TARecord taRec = new TARecord("ATATATATATATATATGTATGTATNTATGTTNGGTATGTGTATATAAAATNTNTTNCAGNGTATAGAAATTTGTTTCTACACTCTT", map);
		
		assertEquals(2, taRec.getLeaderBoardPositionOfPosition(4611686019273935928l));
	}
	
	@Test
	public void getLeaderBoardRealLife4() {
		Map<Integer, TLongList> map = new HashMap<>();
		TLongList list1 = new TLongArrayList();
		list1.addAll(new long[] {2696541821l});
		map.put(9,  list1);
		TLongList list2 = new TLongArrayList();
		list2.addAll(new long[] {1831688100l, 4611686021461268166l});
		map.put(7,  list2);
		TARecord taRec = new TARecord("TTTTGGNCAGNGTCTCNTTCTGTTTNCCAAGCTGGGGNGCCNTGGCNGGATCCCGGCCGCCTGCAANCCCCACCCCCCGGGGTCACGCCNTNCCCCTNCCCCCGCCCCCTCGG", map);
		
		assertEquals(1, taRec.getLeaderBoardPositionOfPosition(2696541596l));
	}
	
	@Test
	public void onBothStrands() {
		TLongList list = new TLongArrayList(new long[] {4611686020004822300l,4611686020337386426l,4611686021473452101l,4611686020337386425l,4611686020922020633l});
		BitSet bs = TARecord.areBothStrandsRepresented(list);
		assertEquals(1, bs.cardinality());
		assertEquals(false, bs.get(0));
		assertEquals(true, bs.get(1));
	}
	
	@Test
	public void getPerfectMatch() {
		String seq = "AAAAAAAAAACCCCCCCCCCGGGGGGGGGGTTTTTTTTTT";
		Map<Integer, TLongList> map = new HashMap<>();
		TLongList list = new TLongArrayList();
		list.add(12345678990l);
		map.put(NumberUtils.pack2IntsInto1(seq.length() - TiledAlignerUtil.TILE_LENGTH + 1, 0), list);
		TARecord rec = new TARecord(seq, map);
		assertEquals(list, rec.getPerfectMatchPositions());
		
		/*
		 * clear map, put in match count less than perfect match count 
		 */
		map.clear();
		map.put(seq.length() - TiledAlignerUtil.TILE_LENGTH - 10, list);
		rec = new TARecord(seq, map);
		assertEquals(null, rec.getPerfectMatchPositions());
	}
	
	@Test
	public void getMultipleCompounds() {
		Map<String, TLongList> map = new HashMap<>();
		map.put("CATGTATCCAAGA", new TLongArrayList(new long[] {49573418l, 114656855l, 181950606l, 196080513l, 213879289l, 279169993l, 299667247l, 321725052l, 362134554l, 386712950l, 405883566l, 407516869l, 441225975l, 481210699l, 570699947l, 570755577l, 593344754l, 599182635l, 638265975l, 672501816l, 723110115l, 733963246l, 792300124l, 807853514l, 856030216l, 889201592l, 897418246l, 914686592l, 949793932l, 985001734l, 985003199l, 1118126781l, 1142401591l, 1204759938l, 1210502429l, 1246672292l, 1270950331l, 1340746802l, 1360010668l, 1365361953l, 1377148412l, 1398826245l, 1412117074l, 1416778500l, 1427601710l, 1484427448l, 1519383462l, 1528475515l, 1530265185l, 1535275654l, 1565276148l, 1570275889l, 1659965110l, 1682709834l, 1785560613l, 1790160363l, 1822501345l, 1853670228l, 1857480323l, 1899392928l, 1904605682l, 1935109561l, 1945458663l, 1995902452l, 2157762363l, 2170250678l, 2176684341l, 2187777955l, 2190662125l, 2193177727l, 2266489805l, 2339477441l, 2377290885l, 2403483065l, 2503261869l, 2521121529l, 2563614047l, 2568286387l, 2619231863l, 2627328338l, 2639327722l, 2697569002l, 2703952737l, 2732299192l, 2774027828l, 2810117670l, 2865046880l, 2903924218l, 2929312570l, 2956755988l, 2966899566l, 2969218086l, 2982985928l, 3017633711l, 3100356128l}));
		map.put("ATGTATCCAAGAA" , new TLongArrayList(new long[] {29276805l, 80247690l, 181950607l, 185553130l, 204819017l, 254914066l, 279169994l, 299667248l, 362134555l, 386712951l, 397065377l, 405883567l, 529022716l, 547904492l, 566885346l, 570699948l, 589169453l, 593344755l, 597561146l, 599182636l, 634530089l, 638265976l, 672501817l, 723110116l, 735672592l, 788923293l, 792300125l, 803045803l, 807853515l, 856030217l, 889201593l, 897418247l, 914686593l, 920861833l, 923055867l, 949793933l, 968853012l, 982990509l, 1021276700l, 1060851378l, 1118126782l, 1126186787l, 1131642665l, 1142401592l, 1193258860l, 1195702869l, 1204759939l, 1246672293l, 1246696100l, 1270950332l, 1285035841l, 1317409290l, 1319287480l, 1340746803l, 1360010669l, 1396540590l, 1398826246l, 1416778501l, 1484427449l, 1488279859l, 1519383463l, 1528475516l, 1570275890l, 1574914487l, 1659965111l, 1682709835l, 1735711578l, 1754356399l, 1767879067l, 1773462624l, 1785560614l, 1790160364l, 1822501346l, 1836835357l, 1857480324l, 1904605683l, 1945458664l, 1960983028l, 1961348578l, 1995902453l, 2033123363l, 2080795871l, 2141941358l, 2174209017l, 2177132165l, 2186462332l, 2187748336l, 2187777956l, 2190662126l, 2193683675l, 2222332739l, 2259100116l, 2266489806l, 2281890889l, 2283151981l, 2283743563l, 2285136333l, 2339477442l, 2368957995l, 2372858546l, 2398432895l, 2403483066l, 2503261870l, 2521121530l, 2562293563l, 2563614048l, 2568286388l, 2608211991l, 2627328339l, 2630405956l, 2639327723l, 2732299193l, 2774027829l, 2817770256l, 2865046881l, 2903924219l, 2908758184l, 2910098378l, 2929312571l, 2946991723l, 2956755989l, 2990627548l, 3004650826l, 3100356129l}));
		map.put("TGTATCCAAGAAC" , new TLongArrayList(new long[] {181950608l, 238834251l, 279169995l, 282711716l, 299667249l, 353500754l, 362134556l, 377125374l, 386712952l, 405883568l, 469798165l, 470832976l, 513418182l, 593344756l, 607599727l, 638265977l, 672501818l, 723110117l, 751923328l, 792300126l, 807853516l, 856030218l, 878873098l, 904555301l, 914686594l, 920861834l, 949793934l, 982990510l, 1204759940l, 1270950333l, 1319287481l, 1340746804l, 1360010670l, 1396540591l, 1416778502l, 1495507812l, 1515479714l, 1528475517l, 1570275891l, 1659965112l, 1682709836l, 1857480325l, 1945458665l, 1961348579l, 1975509717l, 1995902454l, 2033123364l, 2069892626l, 2141941359l, 2187777957l, 2222332740l, 2339477443l, 2436334150l, 2503261871l, 2563614049l, 2568286389l, 2608211992l, 2627328340l, 2639327724l, 2757266111l, 2774027830l, 2849144198l, 2865046882l, 2903924220l, 2910098379l, 2956755990l, 3004650827l, 3100356130l}));
		map.put("GTATCCAAGAACT", new TLongArrayList(new long[] {181950609l, 238834252l, 279169996l, 282711717l, 299667250l, 302621969l, 323218777l, 335912469l, 348969288l, 353500755l, 362134557l, 386712953l, 405883569l, 543747672l, 593344757l, 600770663l, 604585673l, 607599728l, 638265978l, 672501819l, 723110118l, 792300127l, 807853517l, 834318731l, 856030219l, 897955193l, 914686595l, 920529323l, 920861835l, 949793935l, 1061512267l, 1085991238l, 1144876888l, 1170249742l, 1204759941l, 1270950334l, 1319287482l, 1340746805l, 1360010671l, 1406152492l, 1416778503l, 1471984708l, 1499103783l, 1528475518l, 1545618905l, 1570275892l, 1646030215l, 1659965113l, 1682709837l, 1857480326l, 1937489962l, 1995902455l, 2033123365l, 2069892627l, 2131066463l, 2141941360l, 2187777958l, 2222332741l, 2255915684l, 2339477444l, 2363786814l, 2503261872l, 2563614050l, 2568286390l, 2596415369l, 2608211993l, 2627328341l, 2639327725l, 2757266112l, 2774027831l, 2811003708l, 2848632295l, 2851438311l, 2865046883l, 2903924221l, 2911246258l, 2954397341l, 2956755991l, 3004650828l, 3005881692l, 3100356131l}));
		map.put("TATCCAAGAACTT", new TLongArrayList(new long[] {49490433l, 181950610l, 204821238l, 222907003l, 238834253l, 246623495l, 279169997l, 282711718l, 299667251l, 302621970l, 348969289l, 353500756l, 362134558l, 386712954l, 392117252l, 405883570l, 426480860l, 428124846l, 475337467l, 497582879l, 543747673l, 576236491l, 593344758l, 607599729l, 638265979l, 640118807l, 672501820l, 718969370l, 723110119l, 723956071l, 792300128l, 807853518l, 829725823l, 856030220l, 861860273l, 866890102l, 911458974l, 914686596l, 920861836l, 949793936l, 1085991239l, 1202167761l, 1204759942l, 1244278268l, 1265734279l, 1270950335l, 1315231368l, 1331117963l, 1340746806l, 1360010672l, 1416778504l, 1431963260l, 1440275137l, 1471984709l, 1485698629l, 1528475519l, 1545618906l, 1571021526l, 1659965114l, 1682709838l, 1857480327l, 1937489963l, 1975093671l, 1993125429l, 1995902456l, 2016684993l, 2030415413l, 2109550766l, 2136230547l, 2141941361l, 2154406720l, 2187777959l, 2222332742l, 2268548671l, 2304532192l, 2327867521l, 2339477445l, 2343549294l, 2388311668l, 2412642830l, 2486148768l, 2489281915l, 2503261873l, 2563614051l, 2568286391l, 2568378271l, 2596415370l, 2601906713l, 2608211994l, 2616880373l, 2627328342l, 2639327726l, 2692121285l, 2728159138l, 2774027832l, 2777577471l, 2811003709l, 2865046884l, 2903924222l, 2954397342l, 2956755992l, 3002134980l, 3005881693l, 3100356132l}));
		map.put("ATCCAAGAACTTA", new TLongArrayList(new long[] {49490434l, 164272699l, 181950611l, 203930611l, 222907004l, 237552832l, 279169998l, 280669704l, 282711719l, 299667252l, 310446600l, 335831010l, 353500757l, 362134559l, 386712955l, 405883571l, 444045150l, 464701841l, 497582880l, 500937798l, 501915061l, 607599730l, 630134723l, 638265980l, 672501821l, 718969371l, 723110120l, 729802188l, 752111898l, 792300129l, 807853519l, 856030221l, 860931064l, 861860274l, 883302703l, 911458975l, 914686597l, 920861837l, 949793937l, 958335879l, 1161442828l, 1168386654l, 1202167762l, 1204759943l, 1237029100l, 1265734280l, 1270950336l, 1275322640l, 1311789505l, 1322984496l, 1331117964l, 1340746807l, 1360010673l, 1384220779l, 1416778505l, 1417453222l, 1440275138l, 1485698630l, 1506695679l, 1528475520l, 1545618907l, 1615583788l, 1632655004l, 1639473804l, 1659965115l, 1682709839l, 1700410685l, 1739145542l, 1834180559l, 1840322131l, 1857480328l, 1857964229l, 1891191666l, 1896396768l, 1967853124l, 1981522953l, 1984487248l, 1998383036l, 2016684994l, 2045300159l, 2051574360l, 2109550767l, 2141941362l, 2154406721l, 2172542967l, 2187777960l, 2189137266l, 2222332743l, 2304532193l, 2327867522l, 2339477446l, 2482128427l, 2503261874l, 2563614052l, 2568286392l, 2596415371l, 2608211995l, 2627328343l, 2763662207l, 2772851011l, 2774027833l, 2803750770l, 2811003710l, 2865046885l, 2895108263l, 2903924223l, 2954397343l, 2956755993l, 3003658256l, 3035194724l, 3100356133l}));
		map.put("TCCAAGAACTTAA", new TLongArrayList(new long[] {52398564l, 88407160l, 99460658l, 158795514l, 170756687l, 181950612l, 279169999l, 280669705l, 282711720l, 299667253l, 346077172l, 353500758l, 362134560l, 386712956l, 404964428l, 405883572l, 421249997l, 453687230l, 464165844l, 497582881l, 514512210l, 517334232l, 553483921l, 568873170l, 581986133l, 591234496l, 597460657l, 617286569l, 618238523l, 638265981l, 672501822l, 673355059l, 718969372l, 720600207l, 723110121l, 755029008l, 792300130l, 799101836l, 807853520l, 827289107l, 830196825l, 833825651l, 849418633l, 856030222l, 883302704l, 889248113l, 906516512l, 914686598l, 920861838l, 949793938l, 958335880l, 1018993685l, 1091632813l, 1091704049l, 1109515528l, 1135325578l, 1146939121l, 1161442829l, 1168386655l, 1202167763l, 1204759944l, 1212836021l, 1237029101l, 1260379986l, 1265734281l, 1270950337l, 1275322641l, 1309387746l, 1311789506l, 1322984497l, 1340746808l, 1357633597l, 1360010674l, 1367427852l, 1405959476l, 1416778506l, 1417453223l, 1420890169l, 1446963883l, 1465008047l, 1485698631l, 1528475521l, 1545618908l, 1563562667l, 1615583789l, 1639473805l, 1659707017l, 1659965116l, 1682554271l, 1682709840l, 1684947254l, 1702521248l, 1707266750l, 1717099442l, 1772415652l, 1857480329l, 1880875074l, 1896396769l, 1905023327l, 1907475351l, 1967853125l, 1981522954l, 1998383037l, 2000573685l, 2016684995l, 2051574361l, 2134001095l, 2141941363l, 2157840106l, 2172542968l, 2187777961l, 2222332744l, 2228755579l, 2286248288l, 2304532194l, 2327867523l, 2339477447l, 2400116481l, 2469328443l, 2482128428l, 2503261875l, 2516015354l, 2542409040l, 2563614053l, 2568286393l, 2608211996l, 2611974329l, 2613400213l, 2627328344l, 2654488509l, 2657757250l, 2700579545l, 2759855666l, 2760274793l, 2763662208l, 2764854677l, 2772851012l, 2865046886l, 2888109799l, 2895108264l, 2903924224l, 2936616104l, 2954397344l, 2956755994l, 2964117860l, 2965605551l, 2987774212l, 3030054134l, 3100356134l}));
		map.put("CCAAGAACTTAAG", new TLongArrayList(new long[] {8620033l, 61608511l, 71349155l, 231400300l, 280669706l, 398256597l, 421249998l, 453687231l, 517334233l, 575689116l, 618238524l, 735093896l, 755029009l, 883302705l, 1018993686l, 1078248876l, 1091157156l, 1109515529l, 1131422067l, 1168386656l, 1202167764l, 1254413771l, 1309387747l, 1322984498l, 1328220091l, 1367427853l, 1370563429l, 1682554272l, 1684947255l, 1702521249l, 1717099443l, 1758446039l, 1800970090l, 1896396770l, 1906694433l, 1907475352l, 2050134689l, 2051574362l, 2133427874l, 2157840107l, 2303143650l, 2351651919l, 2355230922l, 2383344528l, 2552813124l, 2563614054l, 2618013217l, 2700579546l, 2749246121l, 2884198049l, 2888109800l, 2895108265l, 2912754968l}));
		map.put("CAAGAACTTAAGA", new TLongArrayList(new long[] {8620034l, 61608512l, 280669707l, 348473245l, 355394324l, 441803741l, 449436395l, 517334234l, 541609812l, 554855270l, 606246203l, 607362243l, 618238525l, 651567867l, 681701757l, 695859073l, 705907611l, 735093897l, 755029010l, 859294374l, 859454886l, 881843982l, 963008505l, 1006262588l, 1061042318l, 1105605261l, 1131422068l, 1141088600l, 1168386657l, 1178768204l, 1187676545l, 1202167765l, 1245164466l, 1309662753l, 1322984499l, 1367427854l, 1368018036l, 1370563430l, 1371121942l, 1507931238l, 1507990429l, 1527995986l, 1676859912l, 1684947256l, 1702521250l, 1713658057l, 1877474888l, 1896396771l, 1897387128l, 1907440373l, 1929121309l, 1936232954l, 1943885429l, 1969757153l, 1975188509l, 1995904404l, 2042967989l, 2133427875l, 2157840108l, 2166268835l, 2176736581l, 2179399836l, 2247754152l, 2280036158l, 2284115589l, 2290520890l, 2355230923l, 2403112187l, 2405561723l, 2416069591l, 2430547113l, 2456618582l, 2516855294l, 2520483854l, 2539192210l, 2547901763l, 2560987013l, 2563614055l, 2713594759l, 2730817489l, 2749246122l, 2815439549l, 2816926218l, 2847168878l, 2884198050l, 2888109801l, 2922432794l, 3016530471l, 3021774184l, 3057042295l}));
		map.put("AAGAACTTAAGAG", new TLongArrayList(new long[] {8620035l, 19081828l, 39044042l, 61608513l, 79036778l, 90584581l, 167079856l, 176026406l, 203311185l, 212352542l, 243786178l, 251659035l, 254945074l, 263669689l, 271940633l, 371479598l, 396182080l, 441803742l, 442374667l, 458195216l, 476510004l, 478458738l, 517334235l, 551212464l, 561317411l, 610038106l, 612135695l, 679361935l, 695859074l, 759551624l, 809400098l, 859454887l, 865800285l, 882514434l, 893477829l, 1003750326l, 1036097412l, 1105605262l, 1141088601l, 1163809447l, 1178768205l, 1188809035l, 1225878921l, 1254523155l, 1299259971l, 1309662754l, 1316104896l, 1325958739l, 1343071292l, 1370563431l, 1406637683l, 1407909905l, 1420437441l, 1503363589l, 1507990430l, 1550337661l, 1616683550l, 1651215872l, 1666331176l, 1678839572l, 1689775892l, 1702240979l, 1704714551l, 1717540080l, 1753925325l, 1798038523l, 1840583635l, 1852940682l, 1877474889l, 1919985002l, 1943577514l, 1975188510l, 2032730485l, 2042055383l, 2079120720l, 2136696819l, 2230495044l, 2257032365l, 2280036159l, 2282991981l, 2296100249l, 2357346605l, 2456618583l, 2467584704l, 2474314417l, 2512249122l, 2534959158l, 2547901764l, 2560987014l, 2573624196l, 2574594628l, 2654590782l, 2659746195l, 2713594760l, 2730817490l, 2800149350l, 2807475239l, 2816204904l, 2847700054l, 2854628285l, 2897812210l, 2906649172l, 2922432795l, 2926535236l, 2954232899l, 2990669649l, 2996147091l, 2998063339l, 3026853822l, 3051252141l, 3053528010l}));
		map.put("AGAACTTAAGAGT", new TLongArrayList(new long[] {4424874l, 18246342l, 23314256l, 32545968l, 69919991l, 79036779l, 103325700l, 176026407l, 243786179l, 250968282l, 254945075l, 255942076l, 271940634l, 277379449l, 287895560l, 312292322l, 326449420l, 330565528l, 371479599l, 379245138l, 385541571l, 393534817l, 397751456l, 410750563l, 478458739l, 517334236l, 562678859l, 642541947l, 679361936l, 732202171l, 861275198l, 895127019l, 914001888l, 915421613l, 921981497l, 931612844l, 1026152268l, 1044935531l, 1048768719l, 1105605263l, 1161415949l, 1163809448l, 1178768206l, 1194337482l, 1214692935l, 1309662755l, 1352191640l, 1364071799l, 1406637684l, 1407909906l, 1420437442l, 1430245366l, 1446197890l, 1459680468l, 1503363590l, 1542367791l, 1580203652l, 1582574540l, 1583733808l, 1586172477l, 1605233114l, 1638757131l, 1674605944l, 1675363832l, 1685789952l, 1702240980l, 1705785714l, 1772406261l, 1828400504l, 1852940683l, 1914479970l, 1919985003l, 1966630006l, 2032730486l, 2042055384l, 2124871615l, 2166791184l, 2195810817l, 2261485927l, 2263024770l, 2271147217l, 2278467348l, 2282991982l, 2296100250l, 2303967805l, 2404080854l, 2433281454l, 2438397602l, 2456618584l, 2467584705l, 2474314418l, 2512249123l, 2517061064l, 2528251227l, 2547901765l, 2564625187l, 2574594629l, 2626678511l, 2669377106l, 2721018045l, 2730817491l, 2736225671l, 2806402686l, 2811250166l, 2816204905l, 2847700055l, 2858799767l, 2906649173l, 2931309495l, 2971620575l, 2983761284l, 2996147092l, 3097353636l}));
		map.put("GAACTTAAGAGTA", new TLongArrayList(new long[] {4424875l, 69919992l, 88876767l, 103325701l, 118373358l, 169517582l, 254945076l, 323106078l, 323166125l, 365475879l, 371479600l, 389157140l, 401304580l, 575262516l, 642541948l, 660256954l, 846793371l, 915421614l, 925638660l, 931612845l, 975979226l, 1048768720l, 1079567052l, 1161415950l, 1214692936l, 1228316247l, 1352191641l, 1407909907l, 1446197891l, 1452356443l, 1458719812l, 1503363591l, 1507015692l, 1509864720l, 1519873400l, 1580208541l, 1582579429l, 1583738697l, 1625552318l, 1786722292l, 1798584828l, 1848840745l, 1914479971l, 1966630007l, 2040956617l, 2042055385l, 2058394300l, 2108530225l, 2123396377l, 2124871616l, 2140674307l, 2195810818l, 2271147218l, 2278467349l, 2404080855l, 2528251228l, 2558302962l, 2612247726l, 2721018046l, 2755622012l, 2811250167l, 2816204906l, 2918112611l, 2931997706l, 3035138638l, 3097358525l}));
		map.put("AACTTAAGAGTAT", new TLongArrayList(new long[] {4424876l, 68273695l, 77064653l, 97968633l, 103325702l, 114330607l, 142664087l, 142886981l, 143160534l, 162470935l, 170070536l, 192159340l, 204223979l, 272427124l, 288823340l, 317946983l, 389157141l, 427330859l, 454071340l, 454762322l, 462070958l, 568270237l, 575262517l, 643601796l, 660256955l, 669567798l, 774924820l, 785290024l, 798257860l, 863054339l, 906683692l, 919119816l, 975979227l, 981368277l, 986293058l, 988063508l, 1048768721l, 1085760518l, 1114830080l, 1138409690l, 1159153268l, 1185654527l, 1197752534l, 1214692937l, 1219992961l, 1244520828l, 1266722343l, 1278594781l, 1319908239l, 1358086841l, 1458222247l, 1507015693l, 1528537768l, 1534512294l, 1540520520l, 1580208542l, 1582579430l, 1583738698l, 1613767352l, 1652413714l, 1786722293l, 1845552691l, 1848840746l, 1914479972l, 1966630008l, 1997291753l, 2134381061l, 2190095374l, 2225383525l, 2237651216l, 2249575226l, 2271147219l, 2342683764l, 2416810517l, 2441675598l, 2486164942l, 2486385548l, 2610838012l, 2634853780l, 2636202261l, 2698571452l, 2748060115l, 2766694663l, 2798966714l, 2888472184l, 2920963859l, 2925088490l, 2965193716l, 3027774543l, 3035138639l, 3097358526l, 3098480210l, 3099863540l, 3101423341l}));
		map.put("ACTTAAGAGTATA", new TLongArrayList(new long[] {54281547l, 66100746l, 73307108l, 97968634l, 103325703l, 114330608l, 170070537l, 193470526l, 262032277l, 262873613l, 263865434l, 354566880l, 378996109l, 389157142l, 398226319l, 452455310l, 454071341l, 462070959l, 510788965l, 580573064l, 592313977l, 638187573l, 663986433l, 808729274l, 816821988l, 856550261l, 863054340l, 906683693l, 910259265l, 986293059l, 988063509l, 1007587426l, 1085760519l, 1112281945l, 1114830081l, 1286185328l, 1339760922l, 1507015694l, 1534512295l, 1567892789l, 1617316850l, 1630436190l, 1652413715l, 1688425545l, 1725166081l, 1739055429l, 1743379329l, 1774787706l, 1786722294l, 1821593455l, 2083296473l, 2118613905l, 2237651217l, 2253178018l, 2271147220l, 2290801453l, 2403391191l, 2408991176l, 2468216142l, 2472218128l, 2486164943l, 2610838013l, 2616712690l, 2634853781l, 2636202262l, 2718331015l, 2801261934l, 2807141419l, 2820344473l, 2871570510l, 2888472185l, 2890350608l, 2909645672l, 2925088491l, 3027774544l, 3054171479l, 3098480211l}));
		map.put("CTTAAGAGTATAA", new TLongArrayList(new long[] {29509758l, 66100747l, 78637871l, 103325704l, 114330609l, 170070538l, 220174021l, 262032278l, 263865435l, 278648344l, 317663983l, 378996110l, 398226320l, 402416473l, 408180346l, 509813056l, 510788966l, 527120330l, 537286028l, 578135002l, 610348728l, 617453174l, 638187574l, 663986434l, 673433682l, 677193748l, 706984538l, 715213363l, 737525759l, 776652697l, 808729275l, 816821989l, 909181422l, 910259266l, 968358313l, 972938803l, 987630242l, 988628986l, 1006435995l, 1009512199l, 1057193375l, 1085760520l, 1110990174l, 1249746090l, 1339760923l, 1447377263l, 1487513395l, 1500472522l, 1619119846l, 1629153461l, 1629153620l, 1630436191l, 1633993449l, 1652413716l, 1653285488l, 1688425546l, 1742378159l, 1747164293l, 1779097702l, 1897264200l, 1932067081l, 1941223571l, 1956098406l, 2049968774l, 2140943952l, 2143021348l, 2237651218l, 2245088108l, 2271147221l, 2290801454l, 2292201476l, 2486071997l, 2486164944l, 2486619436l, 2550950729l, 2567505280l, 2614481227l, 2636202263l, 2659741350l, 2732275834l, 2775511680l, 2801261935l, 2871570511l, 2993950686l, 3000270658l, 3019838537l, 3027774545l, 3098480212l}));
		map.put("TTAAGAGTATAAT", new TLongArrayList(new long[] {31751995l, 57409485l, 74230190l, 78637872l, 92657418l, 93524067l, 99386567l, 109184501l, 159364553l, 170070539l, 191911744l, 195686064l, 196357188l, 239129801l, 260247212l, 262032279l, 278648345l, 286901892l, 328527574l, 378996111l, 388915373l, 390474834l, 402179550l, 408180347l, 423469299l, 454713654l, 460239007l, 460892518l, 521682626l, 527120331l, 537286029l, 549126529l, 555010335l, 571776756l, 577857916l, 578135003l, 592713241l, 606483906l, 628334700l, 677193749l, 677494574l, 705807369l, 707303563l, 752978170l, 792374809l, 808055945l, 808729276l, 822311855l, 874129489l, 897481446l, 909181423l, 913828709l, 964857856l, 987630243l, 989266344l, 998450192l, 1053003585l, 1057193376l, 1085760521l, 1091033774l, 1110990175l, 1111427492l, 1111810852l, 1136355534l, 1158607046l, 1182197621l, 1194905156l, 1222475692l, 1249746091l, 1254698023l, 1257202023l, 1259984751l, 1262397569l, 1280429864l, 1337454551l, 1346445795l, 1351656001l, 1354164740l, 1447377264l, 1453687333l, 1457427801l, 1466951226l, 1487513396l, 1491025586l, 1492448822l, 1500472523l, 1505495614l, 1523593505l, 1524945419l, 1534969394l, 1554193377l, 1558271147l, 1559255886l, 1559495579l, 1616026958l, 1654656519l, 1658883240l, 1682173933l, 1684913296l, 1688425547l, 1747164294l, 1750472851l, 1791518714l, 1897185809l, 1918128528l, 1997227374l, 2020333375l, 2050419544l, 2105693456l, 2123423198l, 2123829339l, 2140943953l, 2147629300l, 2180023545l, 2182023143l, 2190246930l, 2190358866l, 2230840720l, 2237651219l, 2266937497l, 2268303112l, 2271147222l, 2332228521l, 2377359026l, 2387716755l, 2402333531l, 2481132340l, 2486071998l, 2486619437l, 2512153795l, 2556039896l, 2567505281l, 2628098872l, 2691680727l, 2732275835l, 2741435550l, 2800990602l, 2893172892l, 2905888528l, 2935326153l, 2961087570l, 2965434616l, 2993519119l, 2993950687l, 2996462730l, 3008692964l, 3011425631l, 3024949555l, 3026070646l, 3027774546l, 3098480213l}));
		map.put("TAAGAGTATAATA", new TLongArrayList(new long[] {14330001l, 87721104l, 92657419l, 112260154l, 119980130l, 159364554l, 178226658l, 187884060l, 195686065l, 244030832l, 260247213l, 262032280l, 269730502l, 378996112l, 388626290l, 388915374l, 409986092l, 435556700l, 442463939l, 521682627l, 537286030l, 565275421l, 570346600l, 571968040l, 577857917l, 578176655l, 581529758l, 598023769l, 629410057l, 652461196l, 677193750l, 707303564l, 722926112l, 752978171l, 787658735l, 800252722l, 800447218l, 806215624l, 808055946l, 808729277l, 817036120l, 855524132l, 893807136l, 897481447l, 913828710l, 948656096l, 987630244l, 989542174l, 990469429l, 1044321480l, 1057193377l, 1074358482l, 1100367498l, 1111427493l, 1111810853l, 1137620540l, 1257202024l, 1268174431l, 1301476781l, 1352113528l, 1354164741l, 1357774544l, 1389408299l, 1417043522l, 1417202791l, 1453687334l, 1457427802l, 1473753103l, 1491025587l, 1492448823l, 1505495615l, 1524945420l, 1529721873l, 1559255887l, 1570500316l, 1573171314l, 1612190480l, 1616026959l, 1682173934l, 1742354515l, 1747164295l, 1768085915l, 1781164031l, 1790619469l, 1791518715l, 1799169426l, 1820208915l, 1820260076l, 1843307320l, 1863763636l, 1920166682l, 1923310243l, 2024345875l, 2048375899l, 2074593272l, 2079233235l, 2123829340l, 2173676563l, 2175802062l, 2178139139l, 2186663932l, 2190246931l, 2190358867l, 2231660342l, 2237651220l, 2285918984l, 2367031262l, 2377359027l, 2402333532l, 2481132341l, 2486071999l, 2492179301l, 2556039897l, 2567505282l, 2583566115l, 2694271070l, 2741435551l, 2799070878l, 2856539776l, 2866736889l, 2957861922l, 2973641714l, 2993950688l, 3011425632l, 3012430501l, 3027757280l, 3027774547l, 3098480214l}));
		map.put("AAGAGTATAATAA", new TLongArrayList(new long[] {25517070l, 92657420l, 119980131l, 121271910l, 158198921l, 159364555l, 178226659l, 187884061l, 197251084l, 258319895l, 260247214l, 321306555l, 367650580l, 372816089l, 387126160l, 392648937l, 417764143l, 422449430l, 433714356l, 458130985l, 545096931l, 559611565l, 570346601l, 571968041l, 578176656l, 581529759l, 605762664l, 647455533l, 661459150l, 722926113l, 745106467l, 751141185l, 751207308l, 758032505l, 776660512l, 781570402l, 781986636l, 789953016l, 793450189l, 832342734l, 838241802l, 850203696l, 852223508l, 855524133l, 880313274l, 891100904l, 893807137l, 913828711l, 938776327l, 941673205l, 963289253l, 985537399l, 987630245l, 1043472759l, 1044321481l, 1057193378l, 1074358483l, 1078429277l, 1113074243l, 1118045628l, 1145192076l, 1148920205l, 1158781326l, 1204539335l, 1220819275l, 1257202025l, 1270339727l, 1301476782l, 1404729357l, 1404975925l, 1417202792l, 1420488528l, 1444648651l, 1457427803l, 1473753104l, 1491025588l, 1497996346l, 1505495616l, 1529721874l, 1621879388l, 1641450825l, 1757829489l, 1761172724l, 1770547095l, 1783079050l, 1825808205l, 1833235798l, 1877611365l, 1895355854l, 1923310244l, 1930143285l, 1981638469l, 1982812495l, 1992631803l, 2014581035l, 2018401654l, 2024345876l, 2031085890l, 2031446908l, 2051168990l, 2051846820l, 2052173930l, 2057603014l, 2116290147l, 2135889851l, 2138907225l, 2160101245l, 2175802063l, 2178139140l, 2186663933l, 2191059047l, 2237651221l, 2244606192l, 2264570829l, 2270733124l, 2284707555l, 2290071037l, 2353481545l, 2371652494l, 2377359028l, 2402333533l, 2474663628l, 2556039898l, 2559948691l, 2567505283l, 2610564251l, 2623470903l, 2668407107l, 2703738017l, 2704204117l, 2713151255l, 2717850685l, 2798727581l, 2809190914l, 2813209682l, 2813236525l, 2856539777l, 2891950690l, 2894702529l, 2909476786l, 2937557460l, 2949222322l, 2961458163l, 2967656682l, 2968794679l, 2973641715l, 2977327787l, 2983028712l, 2993950689l, 2997881268l, 3027774548l, 3030490433l, 3098480215l}));
		map.put("AGAGTATAATAAT", new TLongArrayList(new long[] {25517071l, 81710820l, 96407915l, 96530666l, 104099170l, 110675024l, 116533032l, 159364556l, 195615394l, 197264176l, 225779708l, 260247215l, 287148535l, 320571602l, 321306556l, 333349536l, 334049967l, 373797268l, 392114906l, 392648938l, 393259543l, 399391801l, 406170691l, 408413951l, 410879728l, 415454713l, 430436799l, 442280220l, 456436702l, 480836414l, 490191379l, 501471727l, 507807446l, 545096932l, 557465339l, 559611566l, 576938378l, 591727685l, 594241669l, 597841342l, 610466930l, 625783805l, 646108375l, 650108446l, 655575923l, 661459151l, 683867058l, 705334165l, 714094829l, 721846280l, 722926114l, 752453661l, 756074428l, 781652148l, 793450190l, 798383392l, 800834171l, 833532104l, 842298065l, 855524134l, 871439381l, 877476179l, 880313275l, 893807138l, 923226794l, 931146804l, 931208767l, 931457741l, 953656257l, 983478717l, 985537400l, 992957600l, 1001717576l, 1004319852l, 1043472760l, 1101085652l, 1113074244l, 1161513147l, 1167370571l, 1187873372l, 1191618430l, 1191867499l, 1218903237l, 1245483400l, 1248328925l, 1251037811l, 1270339728l, 1272238859l, 1285489133l, 1302787760l, 1404193783l, 1409342491l, 1416788764l, 1420488529l, 1428980284l, 1429428777l, 1450965034l, 1465608436l, 1465716159l, 1473753105l, 1490073943l, 1505495617l, 1510497330l, 1564267875l, 1616795473l, 1619598045l, 1643753870l, 1646537650l, 1648753665l, 1657692896l, 1708753893l, 1709239755l, 1757829490l, 1758950452l, 1791131886l, 1833235799l, 1839314327l, 1865634081l, 1896858275l, 1917579088l, 1929304176l, 1929304214l, 1929304251l, 1969643858l, 1970834123l, 1972908635l, 1974513452l, 2024345877l, 2025281125l, 2037329913l, 2037782694l, 2057603015l, 2068607304l, 2126092277l, 2138907226l, 2146806471l, 2160101246l, 2170966611l, 2175802064l, 2193213617l, 2229657519l, 2247942828l, 2260684750l, 2270733125l, 2280176291l, 2285858741l, 2295647861l, 2350851975l, 2351805435l, 2353481546l, 2363083824l, 2371652495l, 2389680419l, 2417096044l, 2456364694l, 2469680240l, 2520044219l, 2567916186l, 2619193979l, 2645544843l, 2646859933l, 2647290670l, 2655722968l, 2731580591l, 2774027845l, 2807605722l, 2808439941l, 2813209683l, 2856895105l, 2914356961l, 2922222052l, 2947561444l, 2949222323l, 2952089220l, 2968794680l, 2977327788l, 2993950690l, 2997272047l, 3019492534l, 3030490434l, 3059293168l}));
		map.put("GAGTATAATAATA", new TLongArrayList(new long[] {25517072l, 67321052l, 75742258l, 81710821l, 96407916l, 99585905l, 104099171l, 110675025l, 161045997l, 197264177l, 203573790l, 206602316l, 215747464l, 225779709l, 283752392l, 296402237l, 300944545l, 320571603l, 334049968l, 392648939l, 399391802l, 406170692l, 408413952l, 410879729l, 415454714l, 441495178l, 442280221l, 443418870l, 456436703l, 480836415l, 484289883l, 489506404l, 490191380l, 507341039l, 511783582l, 517243575l, 548371216l, 557465340l, 559611567l, 569303840l, 576938379l, 594241670l, 602122487l, 610466931l, 625783806l, 628337581l, 646108376l, 650108447l, 683867059l, 705334166l, 714094830l, 722926115l, 735699982l, 769311324l, 798347594l, 800834172l, 803997882l, 833532105l, 842298066l, 855524135l, 855904340l, 871439382l, 877476180l, 893807139l, 923226795l, 931146805l, 931208768l, 936740865l, 953656258l, 985537401l, 987360609l, 992957601l, 1000346542l, 1001717577l, 1003493451l, 1064326337l, 1070889959l, 1100702783l, 1113074245l, 1119094242l, 1144573280l, 1161513148l, 1167370572l, 1191867500l, 1195946702l, 1204901356l, 1206007529l, 1218903238l, 1242723572l, 1245483401l, 1255035830l, 1265940390l, 1275222702l, 1302787761l, 1314806097l, 1369248937l, 1409342492l, 1429428778l, 1450965035l, 1465608437l, 1502454298l, 1505495618l, 1506728304l, 1515565140l, 1561103325l, 1564267876l, 1568469234l, 1576700774l, 1619598046l, 1643753871l, 1646537651l, 1648753666l, 1653266237l, 1657692897l, 1741570573l, 1758950453l, 1759460831l, 1778901541l, 1791131887l, 1861753837l, 1865634082l, 1896858276l, 1917579089l, 1929304177l, 1929304215l, 1929304252l, 1945355640l, 1968682676l, 1969643859l, 1970834124l, 1972908636l, 1995852892l, 2021906721l, 2024453931l, 2025281126l, 2037329914l, 2037782695l, 2041856421l, 2057603016l, 2068607305l, 2133320063l, 2138907227l, 2144832107l, 2146806472l, 2156951050l, 2160101247l, 2227863991l, 2229657520l, 2247942829l, 2260684751l, 2270733126l, 2286127914l, 2291661818l, 2363083825l, 2377621064l, 2401329400l, 2401330643l, 2417096045l, 2420045586l, 2466524417l, 2469680241l, 2477168677l, 2551701535l, 2556193833l, 2557318565l, 2561132082l, 2567916187l, 2645544844l, 2646859934l, 2647798153l, 2655722969l, 2726087574l, 2727430177l, 2728081266l, 2731580592l, 2738604838l, 2757797090l, 2758934046l, 2774027846l, 2804065615l, 2807605723l, 2822692027l, 2856895106l, 2877627542l, 2914356962l, 2928036608l, 2947561445l, 2952089221l, 2968794681l, 2970748296l, 2981649716l, 2997272048l, 3006982822l, 3009742985l, 3013774084l, 3019492535l, 3030490435l, 3040209631l, 3059293169l, 3063963095l}));
		map.put("AGTATAATAATAA", new TLongArrayList(new long[] {-9223372036854767985l}));
		map.put("GTATAATAATAAT", new TLongArrayList(new long[] {-9223372036854770339l}));
		map.put("TATAATAATAATA", new TLongArrayList(new long[] {-9223372036854769130l}));
		map.put("ATAATAATAATAA", new TLongArrayList(new long[] {-9223372036854725005l}));
		map.put("TAATAATAATAAT", new TLongArrayList(new long[] {-9223372036854735632l}));
		map.put("AATAATAATAATA", new TLongArrayList(new long[] {-9223372036854727213l}));
		
		Map<Integer, TLongList> map2 = TiledAlignerUtil.getTiles(map, "CATGTATCCAAGAACTTAAGAGTATAATAATAATAATA", 13, false);
		for (Entry<Integer, TLongList> entry : map2.entrySet()) {
			System.out.println("entry getKey: " + Arrays.toString(NumberUtils.splitIntInto2(entry.getKey())) + ", list size: " + entry.getValue().size());
		}
		assertArrayEquals(new long[] {2563614047l}, map2.get(NumberUtils.pack2IntsInto1(9, 0)).toArray());
		assertEquals(true, map2.get(NumberUtils.pack2IntsInto1(6, 0)).contains(2774027828l));
		assertArrayEquals(new long[] {181950606, 279169993, 299667247, 362134554, 386712950, 405883566, 638265975, 672501816, 723110115, 792300124, 807853514, 856030216, 914686592, 949793932, 1204759938, 1270950331, 1340746802, 1360010668, 1416778500, 1528475515, 1659965110, 1682709834, 1857480323, 2187777955l, 2339477441l, 2503261869l, 2568286387l, 2627328338l, 2865046880l, 2903924218l, 2956755988l, 3100356128l}, map2.get(NumberUtils.pack2IntsInto1(7, 0)).toArray());
	}
	

}
