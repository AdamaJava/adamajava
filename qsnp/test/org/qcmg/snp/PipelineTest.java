package org.qcmg.snp;

import static org.junit.Assert.assertEquals;

import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.concurrent.CountDownLatch;
import java.util.concurrent.atomic.AtomicInteger;

import org.junit.Rule;
import org.junit.Test;
import org.junit.rules.TemporaryFolder;
import org.qcmg.common.model.Accumulator;
import org.qcmg.common.util.Constants;
import org.qcmg.common.util.TabTokenizer;
import org.qcmg.common.vcf.header.VcfHeader;
import org.qcmg.common.vcf.header.VcfHeaderUtils;
import org.qcmg.picard.SAMRecordFilterWrapper;
import org.qcmg.picard.util.SAMUtils;

import htsjdk.samtools.SAMFileHeader;
import htsjdk.samtools.SAMRecord;

public class PipelineTest {
	
	@Rule
	public final TemporaryFolder testFolder = new TemporaryFolder();
	
	
//	@Test
//	public void getCountFromString() {
//		assertEquals(1, Pipeline.getCountFromString("A1", 'A'));
//		assertEquals(1, Pipeline.getCountFromString("A1;B2", 'A'));
//		assertEquals(2, Pipeline.getCountFromString("A1;B2", 'B'));
//		assertEquals(-1, Pipeline.getCountFromString("A1;B2", 'C'));
//		assertEquals(10, Pipeline.getCountFromString("C10;A1;B2", 'C'));
//		assertEquals(-1, Pipeline.getCountFromString("C10;A1;B2", 'X'));
//	}
	
//	@Test
//	public void accumulateReadBases() {
//		final Pipeline pipeline = new TestPipeline();
//		
//		Map<Long, StringBuilder>readSeqMap = new HashMap<>();
//		Accumulator acc = new Accumulator(100);
//		acc.addBase((byte)'C', (byte)30, true, 100, 100, 200, 1);
//		
//		pipeline.accumulateReadBases(acc, readSeqMap, 100);
//		
//		assertEquals(1, readSeqMap.size());
//		
//		Accumulator acc2 = new Accumulator(101);
//		acc2.addBase((byte)'C', (byte)30, true, 101, 101, 200, 1);
//		
//		pipeline.accumulateReadBases(acc2, readSeqMap, 101);
////		assertEquals(2, readSeqMap.size());
//	}
	
	@Test
	public void getHeader() {
		VcfHeader h = Pipeline.getHeaderForQSnp("abc", "123", "456", "qsnp", null, null, "xyz");
		assertEquals(true, null != h.getFormatRecord(VcfHeaderUtils.FORMAT_OBSERVED_ALLELES_BY_STRAND));
		assertEquals(true, h.getFormatRecord(VcfHeaderUtils.FORMAT_OBSERVED_ALLELES_BY_STRAND).toString().contains(VcfHeaderUtils.FORMAT_OBSERVED_ALLELES_BY_STRAND_DESC));
	}
	
	
	@Test
	public void getAccumulatorsFromReads() throws IOException {
		final Pipeline pipeline = new TestPipeline();
		
		CountDownLatch consumerLatch = new CountDownLatch(1);
		CountDownLatch normalLatch = new CountDownLatch(1);
		CountDownLatch tumourLatch = new CountDownLatch(1);
		
		Accumulator[] array = new Accumulator[5000000];
		Pipeline.Consumer c = pipeline.new Consumer(consumerLatch, normalLatch, tumourLatch, true, null, null, array, null, new AtomicInteger(100));
		List<SAMRecord> records = getRecords();
		assertEquals(33, records.size());
		int readId = 1;
		for (SAMRecord rec : records) {
			if (SAMUtils.isSAMRecordValidForVariantCalling(rec)) {
				SAMRecordFilterWrapper srw = new SAMRecordFilterWrapper(rec, readId++);
				srw.setPassesFilter(true);
				c.processSAMRecord(srw);
			} else {
				System.out.println("invalid rec: " + rec.toString());
			}
		}
//		
//		int i = 0 ;
//		for (Accumulator acc : array) {
//			i++;
//			if (acc != null) {
//				System.out.println("acc: " + acc.toString() + " at position " + i);
//			}
//		}
		assertEquals("4511341:T9[24]18[36.44]", array[4511341].toString());
	}
	
	private List<SAMRecord> getRecords() {
		SAMFileHeader header = new SAMFileHeader();
		
		List<SAMRecord> recs = new ArrayList<>();
		
		recs.add(createSamRec("NS500239:41:H2HW7BGXX:3:21509:6917:16433	163	chr19	4511262	60	114M	=	4511262	114	CTGTGAGCCCAGTGGACACGGCATCTTTAGTGCCAGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACTTTCGCAGCACCGGTCACCCCACTGC	AAAAA7FFFFFFFFFFFFFFFFFFFAFFAFFFFFFFFFFFFFFFFAFFFFFFFFAFFFFFFFFFFFFFFFF)FFFFFFF7FFFFFFFF7FFFFF77FAFFAFFF7FFFFFFFFF	XA:Z:chr19,+4511658,114M,4;	ZC:i:3	MD:Z:114	PG:Z:MarkDuplicates	RG:Z:88f8f4c2-7fff-4248-a79b-66ca71b90d09	NM:i:0	AS:i:114	XS:i:94", header));
		recs.add(createSamRec("NS500239:41:H2HW7BGXX:3:21509:6917:16433	83	chr19	4511262	60	114M	=	4511262	-114	CTGTGAGCCCAGTGGACACGGCATCTTTAGTGCCAGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACTTTCGCAGCACCGGTCACCCCACTGC	FFFFFFFFFAFF7FFF.FFFFFFFFFAAFFFFFFFFAFF<FFFFFFFF7FFFFF.FAFAFFFFFFFFFFFFAFAFFFFFFFFFFFFFFFFFFFFFFAFFFFFAFFFFFFAAAA<	XA:Z:chr19,-4511658,114M,4;	ZC:i:3	MD:Z:114	PG:Z:MarkDuplicates	RG:Z:88f8f4c2-7fff-4248-a79b-66ca71b90d09	NM:i:0	AS:i:114	XS:i:94", header));
		recs.add(createSamRec("NS500239:41:H2HW7BGXX:3:23604:20499:19661	99	chr19	4511263	60	150M	=	4511283	171	TGTGAGCCCAGTGGACACAGCATCTTTAGTGCCAGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTACCTGTTGCGATATTTTGGGT	AAAA<F<FFFFFFFFFFFFFFFFFFFFAFFFFFFFFFFFFFFFFAFFFFFFFFAFFFF.FF<F<F<F7AFFAFF)F<FF<FFFFFFFF<FF.FAFFF<FFAFF7<FF<FFF.FFFAF.F)AFFFF)F.F.FF7FF7<F<F.AFFA7<FFF	ZC:i:3	MD:Z:18G68T62	PG:Z:MarkDuplicates	RG:Z:88f8f4c2-7fff-4248-a79b-66ca71b90d09	NM:i:2	AS:i:140	XS:i:103", header));
		recs.add(createSamRec("NS500239:3:H0PLWAGXX:3:12408:3456:2097	147	chr19	4511280	60	107M	=	4511280	-107	CAGCATCTTTAGTGCCAGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTC	FFF7FFFAFAFFFFFFFFFAFFFFAFFAFFFAFFFFFFFF<<FFFFF7..FFFFFFFFAFFFFFFFFFF.FAFFFFFFAFFFFFAFFFFFFFFFFFFFFFFFAAAAA	XA:Z:chr19,-4511676,96M11S,2;chr19,-4512468,96M11S,2;	ZC:i:7	MD:Z:1G68T36	PG:Z:MarkDuplicates	RG:Z:cab6d719-bc86-46f3-a80d-a1b1d747b2b8	NM:i:2	AS:i:100	XS:i:86", header));
		recs.add(createSamRec("NS500239:3:H0PLWAGXX:1:12108:24586:5530	163	chr19	4511282	60	102M	=	4511282	102	GCATCTTTAGTGCCAGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTG	AAAAAFFFFFFFFFFFFFFFFFFFFAFFAFFFFFAFFFF<FFFFFFFFFFF)FAFFFFF77F<F.FFFFFF<FFFFF<FAFFF..FFFFAFF.FFFFAFFFF	XA:Z:chr19,+4512470,94M8S,2;chr19,+4511678,94M8S,2;	ZC:i:6	MD:Z:68T33	PG:Z:MarkDuplicates	RG:Z:93ffe214-4381-4767-a36f-b17d0999f87b	NM:i:1	AS:i:97	XS:i:84", header));
		recs.add(createSamRec("NS500239:3:H0PLWAGXX:1:12108:24586:5530	83	chr19	4511282	60	102M	=	4511282	-102	GCATCTTTAGTGCCAGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTG	FFFFFFA.FFFFFF<FFF<FFFFFFFFFFFFFAFFFFFFFFFFFFFFFAFA<FFFFFFFFFFFFFF7FAFFFFFFFFFFFFFAFFFFFAFFAFFFFFAAAAA	XA:Z:chr19,-4512470,94M8S,2;chr19,-4511678,94M8S,2;	ZC:i:6	MD:Z:68T33	PG:Z:MarkDuplicates	RG:Z:93ffe214-4381-4767-a36f-b17d0999f87b	NM:i:1	AS:i:97	XS:i:84", header));
		recs.add(createSamRec("NS500239:41:H2HW7BGXX:3:23604:20499:19661	147	chr19	4511283	60	151M	=	4511263	-171	CATCTTTAGTGCCAGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTACCTGTTGCGATATTTTGGGTCGTTTTCAGCCCAGTTTGCAC	.FFAFF7FFFF7FFA.FFFF7.)AFFFFFFFFFFF.FFFFFFFA<FFFFFFFFAFFAFFFFFFFAFFFFFFFFFFFFFFFFFFFFFFFFFFFAF<FFFFFFFAFFFFFFFFFFFFFFFFFFFFFFFFFF<FFFFFFFFFFFFFFFFAAAA<	ZC:i:3	MD:Z:67T83	PG:Z:MarkDuplicates	RG:Z:88f8f4c2-7fff-4248-a79b-66ca71b90d09	NM:i:1	AS:i:146	XS:i:83", header));
		recs.add(createSamRec("NS500239:3:H0PLWAGXX:2:23109:9676:19825	163	chr19	4511286	60	87M63S	=	4511286	90	CTATAGTGCCAGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACTTTCGCAGCACCGGTCACCCCACAGCCTGTCACTAATACACATCAGCCGCTGCCGACGAGCGATCTAGTGTAGATCTCGGTGGTCG	AA)A<AFFFFFFFFFA<FFFFFFFFFF<FFAFFF<FFFFFAFFFAFAFF.FFFFF.F.)F)F)F)<<7.F<)F)FF<F<FFF)FFFF7.FFF.FF)F<.7F<A)F..))))FFFF.F7777F<FFF.FF)<)F.FF.AAF<F<FF.F)..	XA:Z:chr19,+4511685,3S84M63S,3;	ZC:i:0	MD:Z:2T84	PG:Z:MarkDuplicates	RG:Z:4605536e-3e37-4b15-b236-699c54c05da8	NM:i:1	AS:i:84	XS:i:69", header));
		recs.add(createSamRec("NS500239:3:H0PLWAGXX:2:23109:9676:19825	83	chr19	4511286	60	90M	=	4511286	-90	CTTTAGTGCCAGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACTTTCGCAGCACCGGTCACCCCACTGC	FFAFFFF..FFA<A7FFFAFFFFFFFF<FFFFFF<AF.FFFFFFFFFFFAFFFFA<FFFFF<FFFFFAFF)FFFAFFFFAFFFAAAAAAA	XA:Z:chr19,-4511682,90M,3;	ZC:i:0	MD:Z:90	PG:Z:MarkDuplicates	RG:Z:4605536e-3e37-4b15-b236-699c54c05da8	NM:i:0	AS:i:90	XS:i:75", header));
		recs.add(createSamRec("NS500239:3:H0PLWAGXX:3:22403:24045:1856	99	chr19	4511296	53	53M	=	4511296	53	AGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGACA	A7AAAFFAFFFF<FF<FFAFAAF77.F.FFFFFFFF<FAFFFFFF)F77F.AF	XA:Z:chr19,+4512484,53M,2;	ZC:i:7	MD:Z:50C2	PG:Z:MarkDuplicates	RG:Z:cab6d719-bc86-46f3-a80d-a1b1d747b2b8	NM:i:1	AS:i:50	XS:i:45", header));
		recs.add(createSamRec("NS500239:41:H2HW7BGXX:4:11506:2944:15443	163	chr19	4511296	60	98M	=	4511296	98	AGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTAC	AAAAAFFFFFFFFFFFFFFFFFFFFFFFFFFFFF77F.FFFFFFF.FF.FFFFFFAF.FFFFF<FF7FFAFFAFF<F7FFFFFFFFAFFFFFFF7FFF	ZC:i:5	MD:Z:54T43	PG:Z:MarkDuplicates	RG:Z:b7c1f9b0-a616-4ff3-80db-ba4335dfdc96	NM:i:1	AS:i:93	XS:i:70", header));
		recs.add(createSamRec("NS500239:3:H0PLWAGXX:3:22403:24045:1856	147	chr19	4511296	54	53M	=	4511296	-53	AGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCA	FF)FFF.FFFFF<FFAFF<FFA.FAFFFAFFFFFFFFAFFFFFFFFFFAAAAA	XA:Z:chr19,-4512484,53M,1;chr19,-4511692,53M,2;	ZC:i:7	MD:Z:53	PG:Z:MarkDuplicates	RG:Z:cab6d719-bc86-46f3-a80d-a1b1d747b2b8	NM:i:0	AS:i:53	XS:i:48", header));
		recs.add(createSamRec("NS500239:41:H2HW7BGXX:4:11506:2944:15443	83	chr19	4511296	60	98M	=	4511296	-98	AGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTAC	A<FFFFFFAFFFFFFFFAFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFF<FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAFFFFFFAAAA<	ZC:i:5	MD:Z:54T43	PG:Z:MarkDuplicates	RG:Z:b7c1f9b0-a616-4ff3-80db-ba4335dfdc96	NM:i:1	AS:i:93	XS:i:70", header));
		recs.add(createSamRec("NS500239:41:H2HW7BGXX:2:21204:21162:7134	99	chr19	4511301	60	94M	=	4511301	94	GGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTACC	AAAAAFFFFFFFFAFFFFFF<FFFFFFFFFFF.FFFFFFF)FFFFFFFFFFFAFFFFFAFFFFFA.FFFF<FAFFFFFFFF<F7F<FFFFF.FF	ZC:i:4	MD:Z:49T44	PG:Z:MarkDuplicates	RG:Z:612f2236-c0ac-4080-885d-5e6f27f3ad82	NM:i:1	AS:i:89	XS:i:65", header));
		recs.add(createSamRec("NS500239:41:H2HW7BGXX:2:21204:21162:7134	147	chr19	4511301	60	94M	=	4511301	-94	GGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTACC	FFFFFFFFFFAFFFF<FAFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAFFFFAAAAA	ZC:i:4	MD:Z:49T44	PG:Z:MarkDuplicates	RG:Z:612f2236-c0ac-4080-885d-5e6f27f3ad82	NM:i:1	AS:i:89	XS:i:65", header));
		recs.add(createSamRec("NS500239:3:H0PLWAGXX:1:12306:24828:13828	99	chr19	4511306	60	119M	=	4511306	119	GACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTACCTGTTGCGATATTTTGGGTCGTTTTCAGCCC	A<AAAFFF.FAFAF<<FFF)F<FFFAF)FFFA.FF.FFFFAF)FFFF<FF)A)AFFFFFF)F<FFAF)FFFFFFFFFF.FF).FFF.AFFFF7FFAFFF7FFAF..FF.F7FF.FFF7F	ZC:i:6	MD:Z:44T74	PG:Z:MarkDuplicates	RG:Z:93ffe214-4381-4767-a36f-b17d0999f87b	NM:i:1	AS:i:114	XS:i:60", header));
		recs.add(createSamRec("NS500239:41:H2HW7BGXX:1:11310:20819:4441	99	chr19	4511306	49	70M	=	4511306	70	GACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGC	A<AAAFFFAFAFFFF<FFFFAFFFFFFAFFF<FFF)AFFFAFAF.FFAFF7F<)FFFF<77<FFFFF.FF	XA:Z:chr19,+4512494,70M,2;chr19,+4511702,70M,2;	ZC:i:2	MD:Z:44T25	PG:Z:MarkDuplicates	RG:Z:c7f04110-95d0-4a70-8fa4-4fa000ae74e3	NM:i:1	AS:i:65	XS:i:60", header));
		recs.add(createSamRec("NS500239:41:H2HW7BGXX:1:23203:10315:4920	163	chr19	4511306	50	65M86S	=	4511306	65	GACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCCAGTCTCATATACACAACAGACGCTGCCGACGAGCGATCTAGTGTAGATATCGGTGGTCGCCGTATCATTAAAAAAAAAAGGGGGG	<AAAAFFFFFFFFFF<FFFFFFFF<)F)FAFFFFF)FF<FFFAAF)FAFFFAF7FFAFF7.FFFFF7.F7)7.FFFF<.FF))).7A<FF.FFAFF.FAF<.FF<F7FFF<FFF)<).A<.FF7.FF.FAFFAFF7FFF<FFFAF..<F.F	XA:Z:chr19,+4511702,65M86S,2;chr19,+4512494,65M86S,2;	ZC:i:2	MD:Z:44T20	PG:Z:MarkDuplicates	RG:Z:c7f04110-95d0-4a70-8fa4-4fa000ae74e3	NM:i:1	AS:i:60	XS:i:55", header));
		recs.add(createSamRec("NS500239:41:H2HW7BGXX:3:23411:14389:13640	163	chr19	4511306	60	45M	=	4511306	45	GACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACT	AAAAAFFFFFFFFFFFFFFFFFFFA7F7FAFFFFF)FF.FFFAF7	XA:Z:chr19,+4512494,45M,2;	ZC:i:3	MD:Z:45	PG:Z:MarkDuplicates	RG:Z:88f8f4c2-7fff-4248-a79b-66ca71b90d09	NM:i:0	AS:i:45	XS:i:39", header));
		recs.add(createSamRec("NS500239:3:H0PLWAGXX:1:12306:24828:13828	147	chr19	4511306	60	119M	=	4511306	-119	GACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTACCTGTTGCGATATTTTGGGTCGTTTTCAGCCC	FFAFFFFAFFFFFFFFFFAFAFFFF<FFFFFFFAFFFFF<FFFFFFFFFFFFFFFFFFAFFFFFFFFFFFF.FFAFFFA.FFFFFFFFFFFFFFFFFFFFFFFFAFFFFAFFFFAAAAA	ZC:i:6	MD:Z:44T74	PG:Z:MarkDuplicates	RG:Z:93ffe214-4381-4767-a36f-b17d0999f87b	NM:i:1	AS:i:114	XS:i:60", header));
		recs.add(createSamRec("NS500239:41:H2HW7BGXX:1:11310:20819:4441	147	chr19	4511306	49	70M	=	4511306	-70	GACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGC	FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFFFFFFFFFFFFFFFFFFAAAAA	XA:Z:chr19,-4511702,70M,2;chr19,-4512494,70M,2;	ZC:i:2	MD:Z:44T25	PG:Z:MarkDuplicates	RG:Z:c7f04110-95d0-4a70-8fa4-4fa000ae74e3	NM:i:1	AS:i:65	XS:i:60", header));
		recs.add(createSamRec("NS500239:41:H2HW7BGXX:1:23203:10315:4920	83	chr19	4511306	50	65M	=	4511306	-65	GACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCC	FFFFFFFFFFFF<FFFFFFFFFFFFFFFFFFFFFFFFFFFFFAFFFFFFFFFFFFFFFFFAAAAA	XA:Z:chr19,-4511702,65M,2;chr19,-4512494,65M,2;	ZC:i:2	MD:Z:44T20	PG:Z:MarkDuplicates	RG:Z:c7f04110-95d0-4a70-8fa4-4fa000ae74e3	NM:i:1	AS:i:60	XS:i:55", header));
		recs.add(createSamRec("NS500239:41:H2HW7BGXX:3:23411:14389:13640	83	chr19	4511306	60	45M	=	4511306	-45	GACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACT	FFFFFFFFFF.FAFFFFFFFFFFF7<FFFFFFFFFFFFFFAAAAA	XA:Z:chr19,-4512494,44M1S,1;	ZC:i:3	MD:Z:45	PG:Z:MarkDuplicates	RG:Z:88f8f4c2-7fff-4248-a79b-66ca71b90d09	NM:i:0	AS:i:45	XS:i:39", header));
		recs.add(createSamRec("NS500239:3:H0PLWAGXX:3:13612:9316:12508	83	chr19	4511307	43	69M6S	=	4511307	-69	ACTTTGTTGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACTTTCGCAGCACCGGTCACCCCACTGCAGACGG	.FA<AFF))FF.A.F)).FFFFFFFFF.<.FFAFFFF<7FFAFFA<A7AFFFAFFF<AAFFFFFFFFFAFA<AAA	XA:Z:chr19,-4511703,75M,4;chr19,-4512297,75M,5;	ZC:i:7	MD:Z:7A61	PG:Z:MarkDuplicates	RG:Z:cab6d719-bc86-46f3-a80d-a1b1d747b2b8	NM:i:1	AS:i:64	XS:i:55", header));
		recs.add(createSamRec("NS500239:3:H0PLWAGXX:1:23312:15509:4901	99	chr19	4511312	60	64M6S	=	4511312	64	GTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACTTTCGCAGCACCGGTCACCCCACTGCAGACGG	AAAAAFFFF)FFF.<FFFFFF)FFFA.FF<AFFF.A)F<FFAFA.FA.)<FFF..AAF<.AFF<FF.AFF	XA:Z:chr19,+4511708,70M,3;chr19,+4512302,70M,4;	ZC:i:6	MD:Z:64	PG:Z:MarkDuplicates	RG:Z:93ffe214-4381-4767-a36f-b17d0999f87b	NM:i:0	AS:i:64	XS:i:55", header));
		recs.add(createSamRec("NS500239:41:H2HW7BGXX:1:11208:21382:1810	99	chr19	4511312	43	57M	=	4511312	57	GTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACC	AAAAAFFAF)FFF7FFFF<FF)FFFA<<F)FFFF.F.F<AF<FF<FA.FFAF..)FF	XA:Z:chr19,+4512500,57M,2;chr19,+4511708,57M,2;	ZC:i:2	MD:Z:38T18	PG:Z:MarkDuplicates	RG:Z:c7f04110-95d0-4a70-8fa4-4fa000ae74e3	NM:i:1	AS:i:52	XS:i:48", header));
		recs.add(createSamRec("NS500239:3:H0PLWAGXX:1:23312:15509:4901	147	chr19	4511312	60	64M6S	=	4511312	-64	GTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACTTTCGCAGCACCGGTCACCCCACTGCAGACGG	FFFFFF)FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF.FFFFFFFFFFFFAAAA<	XA:Z:chr19,-4511708,70M,3;chr19,-4512302,70M,4;	ZC:i:6	MD:Z:64	PG:Z:MarkDuplicates	RG:Z:93ffe214-4381-4767-a36f-b17d0999f87b	NM:i:0	AS:i:64	XS:i:55", header));
		recs.add(createSamRec("NS500239:41:H2HW7BGXX:1:11208:21382:1810	147	chr19	4511312	43	57M	=	4511312	-57	GTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACC	FAFFAF<FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7AAA<	XA:Z:chr19,-4512500,57M,2;chr19,-4511708,57M,2;	ZC:i:2	MD:Z:38T18	PG:Z:MarkDuplicates	RG:Z:c7f04110-95d0-4a70-8fa4-4fa000ae74e3	NM:i:1	AS:i:52	XS:i:48", header));
		recs.add(createSamRec("NS500239:41:H2HW7BGXX:3:22405:16529:17823	83	chr19	4511326	43	52M4S	=	4511330	-48	CCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCTGTCACCCCACTGCCATGTG	F.FFF)F7)7A.A.FFFA.AFFFA.FF.AAFF.A)F)AFF....<FAAF.<A.))A	XA:Z:chr19,-4512514,50M6S,3;chr19,-4511527,3S47M6S,2;chr19,-4511722,50M6S,3;	ZC:i:3	MD:Z:24T11G15	PG:Z:MarkDuplicates	RG:Z:88f8f4c2-7fff-4248-a79b-66ca71b90d09	NM:i:2	AS:i:42	XS:i:39", header));
		recs.add(createSamRec("NS500239:3:H0PLWAGXX:2:13211:24117:20380	99	chr19	4511331	50	51M	=	4511331	51	GGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGG	AA.AAFFAFFFFFFFFFFFFFFFFFFFFAFFFFFFFFFFFFFFFFFFAFFF	XA:Z:chr19,+4511727,45M6S,1;chr19,+4512519,45M6S,1;chr19,+4511529,45M6S,1;	ZC:i:0	MD:Z:19T31	PG:Z:MarkDuplicates	RG:Z:4605536e-3e37-4b15-b236-699c54c05da8	NM:i:1	AS:i:46	XS:i:41", header));
		recs.add(createSamRec("NS500239:3:H0PLWAGXX:2:13211:24117:20380	147	chr19	4511331	50	51M	=	4511331	-51	GGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGG	FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFFFAFFFAAAAA	XA:Z:chr19,-4511727,45M6S,1;chr19,-4512519,45M6S,1;chr19,-4511529,45M6S,1;	ZC:i:0	MD:Z:19T31	PG:Z:MarkDuplicates	RG:Z:4605536e-3e37-4b15-b236-699c54c05da8	NM:i:1	AS:i:46	XS:i:41", header));
		recs.add(createSamRec("NS500239:3:H0PLWAGXX:1:22302:13302:7408	163	chr19	4511339	60	103M	=	4511339	103	CCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTACCTGTTGCGATATTTTGGGTCGTTTTCAGCCCAGTTTGCACAGCACCCT	AAAAAFFFFFFFFFFFFAFFFFFFFFF.FFFFAFFFFFFFFFFFFFFFFFFFF<FFFFFFFFFFFFFFFFFFFFFFFFFFFFAFFFFFFFFFFFFF<F.FFFF	ZC:i:6	MD:Z:11T91	PG:Z:MarkDuplicates	RG:Z:93ffe214-4381-4767-a36f-b17d0999f87b	NM:i:1	AS:i:98	XS:i:41", header));
		recs.add(createSamRec("NS500239:3:H0PLWAGXX:1:22302:13302:7408	83	chr19	4511339	60	103M	=	4511339	-103	CCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTACCTGTTGCGATATTTTGGGTCGTTTTCAGCCCAGTTTGCACAGCACCCT	FFFFFFFFF<FAF7FFF<AFFFFAF<FFFFFFFF<FFF)7FFF.FAAFFFFFFFFFAFF<FFFFFFFFFFFFFAFFFAFFF<FFFFFFF.FFFFFFFFAAAAA	ZC:i:6	MD:Z:11T91	PG:Z:MarkDuplicates	RG:Z:93ffe214-4381-4767-a36f-b17d0999f87b	NM:i:1	AS:i:98	XS:i:41", header));
		return recs;
	}
	

//	private List<SAMRecord> getRecords() throws IOException {
//		
//		final File file = testFolder.newFile();
//		try (final OutputStream os = new FileOutputStream(file);
//			final PrintStream ps = new PrintStream(os);) {
//			
//			ps.println("@HD	VN:1.0	SO:coordinate");
//			ps.println("@RG	ID:93ffe214-4381-4767-a36f-b17d0999f87b	SM:ES	DS:rl=50	");
//			ps.println("@RG	ID:88f8f4c2-7fff-4248-a79b-66ca71b90d09	SM:ES	DS:rl=50	");
//			ps.println("@RG	ID:cab6d719-bc86-46f3-a80d-a1b1d747b2b8	SM:ES	DS:rl=50	");
//			ps.println("@RG	ID:4605536e-3e37-4b15-b236-699c54c05da8	SM:ES	DS:rl=50	");
//			ps.println("@RG	ID:b7c1f9b0-a616-4ff3-80db-ba4335dfdc96	SM:ES	DS:rl=50	");
//			ps.println("@RG	ID:612f2236-c0ac-4080-885d-5e6f27f3ad82	SM:ES	DS:rl=50	");
//			ps.println("@RG	ID:c7f04110-95d0-4a70-8fa4-4fa000ae74e3	SM:ES	DS:rl=50	");
//			ps.println("@SQ	SN:chr19	LN:255000000");
//			ps.println("NS500239:41:H2HW7BGXX:3:21509:6917:16433	163	chr19	4511262	60	114M	=	4511262	114	CTGTGAGCCCAGTGGACACGGCATCTTTAGTGCCAGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACTTTCGCAGCACCGGTCACCCCACTGC	AAAAA7FFFFFFFFFFFFFFFFFFFAFFAFFFFFFFFFFFFFFFFAFFFFFFFFAFFFFFFFFFFFFFFFF)FFFFFFF7FFFFFFFF7FFFFF77FAFFAFFF7FFFFFFFFF	XA:Z:chr19,+4511658,114M,4;	ZC:i:3	MD:Z:114	PG:Z:MarkDuplicates	RG:Z:88f8f4c2-7fff-4248-a79b-66ca71b90d09	NM:i:0	AS:i:114	XS:i:94");
//			ps.println("NS500239:41:H2HW7BGXX:3:21509:6917:16433	83	chr19	4511262	60	114M	=	4511262	-114	CTGTGAGCCCAGTGGACACGGCATCTTTAGTGCCAGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACTTTCGCAGCACCGGTCACCCCACTGC	FFFFFFFFFAFF7FFF.FFFFFFFFFAAFFFFFFFFAFF<FFFFFFFF7FFFFF.FAFAFFFFFFFFFFFFAFAFFFFFFFFFFFFFFFFFFFFFFAFFFFFAFFFFFFAAAA<	XA:Z:chr19,-4511658,114M,4;	ZC:i:3	MD:Z:114	PG:Z:MarkDuplicates	RG:Z:88f8f4c2-7fff-4248-a79b-66ca71b90d09	NM:i:0	AS:i:114	XS:i:94");
//			ps.println("NS500239:41:H2HW7BGXX:3:23604:20499:19661	99	chr19	4511263	60	150M	=	4511283	171	TGTGAGCCCAGTGGACACAGCATCTTTAGTGCCAGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTACCTGTTGCGATATTTTGGGT	AAAA<F<FFFFFFFFFFFFFFFFFFFFAFFFFFFFFFFFFFFFFAFFFFFFFFAFFFF.FF<F<F<F7AFFAFF)F<FF<FFFFFFFF<FF.FAFFF<FFAFF7<FF<FFF.FFFAF.F)AFFFF)F.F.FF7FF7<F<F.AFFA7<FFF	ZC:i:3	MD:Z:18G68T62	PG:Z:MarkDuplicates	RG:Z:88f8f4c2-7fff-4248-a79b-66ca71b90d09	NM:i:2	AS:i:140	XS:i:103");
//			ps.println("NS500239:3:H0PLWAGXX:3:12408:3456:2097	147	chr19	4511280	60	107M	=	4511280	-107	CAGCATCTTTAGTGCCAGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTC	FFF7FFFAFAFFFFFFFFFAFFFFAFFAFFFAFFFFFFFF<<FFFFF7..FFFFFFFFAFFFFFFFFFF.FAFFFFFFAFFFFFAFFFFFFFFFFFFFFFFFAAAAA	XA:Z:chr19,-4511676,96M11S,2;chr19,-4512468,96M11S,2;	ZC:i:7	MD:Z:1G68T36	PG:Z:MarkDuplicates	RG:Z:cab6d719-bc86-46f3-a80d-a1b1d747b2b8	NM:i:2	AS:i:100	XS:i:86");
//			ps.println("NS500239:3:H0PLWAGXX:1:12108:24586:5530	163	chr19	4511282	60	102M	=	4511282	102	GCATCTTTAGTGCCAGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTG	AAAAAFFFFFFFFFFFFFFFFFFFFAFFAFFFFFAFFFF<FFFFFFFFFFF)FAFFFFF77F<F.FFFFFF<FFFFF<FAFFF..FFFFAFF.FFFFAFFFF	XA:Z:chr19,+4512470,94M8S,2;chr19,+4511678,94M8S,2;	ZC:i:6	MD:Z:68T33	PG:Z:MarkDuplicates	RG:Z:93ffe214-4381-4767-a36f-b17d0999f87b	NM:i:1	AS:i:97	XS:i:84");
//			ps.println("NS500239:3:H0PLWAGXX:1:12108:24586:5530	83	chr19	4511282	60	102M	=	4511282	-102	GCATCTTTAGTGCCAGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTG	FFFFFFA.FFFFFF<FFF<FFFFFFFFFFFFFAFFFFFFFFFFFFFFFAFA<FFFFFFFFFFFFFF7FAFFFFFFFFFFFFFAFFFFFAFFAFFFFFAAAAA	XA:Z:chr19,-4512470,94M8S,2;chr19,-4511678,94M8S,2;	ZC:i:6	MD:Z:68T33	PG:Z:MarkDuplicates	RG:Z:93ffe214-4381-4767-a36f-b17d0999f87b	NM:i:1	AS:i:97	XS:i:84");
//			ps.println("NS500239:41:H2HW7BGXX:3:23604:20499:19661	147	chr19	4511283	60	151M	=	4511263	-171	CATCTTTAGTGCCAGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTACCTGTTGCGATATTTTGGGTCGTTTTCAGCCCAGTTTGCAC	.FFAFF7FFFF7FFA.FFFF7.)AFFFFFFFFFFF.FFFFFFFA<FFFFFFFFAFFAFFFFFFFAFFFFFFFFFFFFFFFFFFFFFFFFFFFAF<FFFFFFFAFFFFFFFFFFFFFFFFFFFFFFFFFF<FFFFFFFFFFFFFFFFAAAA<	ZC:i:3	MD:Z:67T83	PG:Z:MarkDuplicates	RG:Z:88f8f4c2-7fff-4248-a79b-66ca71b90d09	NM:i:1	AS:i:146	XS:i:83");
//			ps.println("NS500239:3:H0PLWAGXX:2:23109:9676:19825	163	chr19	4511286	60	87M63S	=	4511286	90	CTATAGTGCCAGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACTTTCGCAGCACCGGTCACCCCACAGCCTGTCACTAATACACATCAGCCGCTGCCGACGAGCGATCTAGTGTAGATCTCGGTGGTCG	AA)A<AFFFFFFFFFA<FFFFFFFFFF<FFAFFF<FFFFFAFFFAFAFF.FFFFF.F.)F)F)F)<<7.F<)F)FF<F<FFF)FFFF7.FFF.FF)F<.7F<A)F..))))FFFF.F7777F<FFF.FF)<)F.FF.AAF<F<FF.F)..	XA:Z:chr19,+4511685,3S84M63S,3;	ZC:i:0	MD:Z:2T84	PG:Z:MarkDuplicates	RG:Z:4605536e-3e37-4b15-b236-699c54c05da8	NM:i:1	AS:i:84	XS:i:69");
//			ps.println("NS500239:3:H0PLWAGXX:2:23109:9676:19825	83	chr19	4511286	60	90M	=	4511286	-90	CTTTAGTGCCAGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACTTTCGCAGCACCGGTCACCCCACTGC	FFAFFFF..FFA<A7FFFAFFFFFFFF<FFFFFF<AF.FFFFFFFFFFFAFFFFA<FFFFF<FFFFFAFF)FFFAFFFFAFFFAAAAAAA	XA:Z:chr19,-4511682,90M,3;	ZC:i:0	MD:Z:90	PG:Z:MarkDuplicates	RG:Z:4605536e-3e37-4b15-b236-699c54c05da8	NM:i:0	AS:i:90	XS:i:75");
//			ps.println("NS500239:3:H0PLWAGXX:3:22403:24045:1856	99	chr19	4511296	53	53M	=	4511296	53	AGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGACA	A7AAAFFAFFFF<FF<FFAFAAF77.F.FFFFFFFF<FAFFFFFF)F77F.AF	XA:Z:chr19,+4512484,53M,2;	ZC:i:7	MD:Z:50C2	PG:Z:MarkDuplicates	RG:Z:cab6d719-bc86-46f3-a80d-a1b1d747b2b8	NM:i:1	AS:i:50	XS:i:45");
//			ps.println("NS500239:41:H2HW7BGXX:4:11506:2944:15443	163	chr19	4511296	60	98M	=	4511296	98	AGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTAC	AAAAAFFFFFFFFFFFFFFFFFFFFFFFFFFFFF77F.FFFFFFF.FF.FFFFFFAF.FFFFF<FF7FFAFFAFF<F7FFFFFFFFAFFFFFFF7FFF	ZC:i:5	MD:Z:54T43	PG:Z:MarkDuplicates	RG:Z:b7c1f9b0-a616-4ff3-80db-ba4335dfdc96	NM:i:1	AS:i:93	XS:i:70");
//			ps.println("NS500239:3:H0PLWAGXX:3:22403:24045:1856	147	chr19	4511296	54	53M	=	4511296	-53	AGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCA	FF)FFF.FFFFF<FFAFF<FFA.FAFFFAFFFFFFFFAFFFFFFFFFFAAAAA	XA:Z:chr19,-4512484,53M,1;chr19,-4511692,53M,2;	ZC:i:7	MD:Z:53	PG:Z:MarkDuplicates	RG:Z:cab6d719-bc86-46f3-a80d-a1b1d747b2b8	NM:i:0	AS:i:53	XS:i:48");
//			ps.println("NS500239:41:H2HW7BGXX:4:11506:2944:15443	83	chr19	4511296	60	98M	=	4511296	-98	AGTCAGGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTAC	A<FFFFFFAFFFFFFFFAFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFF<FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAFFFFFFAAAA<	ZC:i:5	MD:Z:54T43	PG:Z:MarkDuplicates	RG:Z:b7c1f9b0-a616-4ff3-80db-ba4335dfdc96	NM:i:1	AS:i:93	XS:i:70");
//			ps.println("NS500239:41:H2HW7BGXX:2:21204:21162:7134	99	chr19	4511301	60	94M	=	4511301	94	GGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTACC	AAAAAFFFFFFFFAFFFFFF<FFFFFFFFFFF.FFFFFFF)FFFFFFFFFFFAFFFFFAFFFFFA.FFFF<FAFFFFFFFF<F7F<FFFFF.FF	ZC:i:4	MD:Z:49T44	PG:Z:MarkDuplicates	RG:Z:612f2236-c0ac-4080-885d-5e6f27f3ad82	NM:i:1	AS:i:89	XS:i:65");
//			ps.println("NS500239:41:H2HW7BGXX:2:21204:21162:7134	147	chr19	4511301	60	94M	=	4511301	-94	GGACAGACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTACC	FFFFFFFFFFAFFFF<FAFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFAFFFFAAAAA	ZC:i:4	MD:Z:49T44	PG:Z:MarkDuplicates	RG:Z:612f2236-c0ac-4080-885d-5e6f27f3ad82	NM:i:1	AS:i:89	XS:i:65");
//			ps.println("NS500239:3:H0PLWAGXX:1:12306:24828:13828	99	chr19	4511306	60	119M	=	4511306	119	GACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTACCTGTTGCGATATTTTGGGTCGTTTTCAGCCC	A<AAAFFF.FAFAF<<FFF)F<FFFAF)FFFA.FF.FFFFAF)FFFF<FF)A)AFFFFFF)F<FFAF)FFFFFFFFFF.FF).FFF.AFFFF7FFAFFF7FFAF..FF.F7FF.FFF7F	ZC:i:6	MD:Z:44T74	PG:Z:MarkDuplicates	RG:Z:93ffe214-4381-4767-a36f-b17d0999f87b	NM:i:1	AS:i:114	XS:i:60");
//			ps.println("NS500239:41:H2HW7BGXX:1:11310:20819:4441	99	chr19	4511306	49	70M	=	4511306	70	GACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGC	A<AAAFFFAFAFFFF<FFFFAFFFFFFAFFF<FFF)AFFFAFAF.FFAFF7F<)FFFF<77<FFFFF.FF	XA:Z:chr19,+4512494,70M,2;chr19,+4511702,70M,2;	ZC:i:2	MD:Z:44T25	PG:Z:MarkDuplicates	RG:Z:c7f04110-95d0-4a70-8fa4-4fa000ae74e3	NM:i:1	AS:i:65	XS:i:60");
//			ps.println("NS500239:41:H2HW7BGXX:1:23203:10315:4920	163	chr19	4511306	50	65M86S	=	4511306	65	GACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCCAGTCTCATATACACAACAGACGCTGCCGACGAGCGATCTAGTGTAGATATCGGTGGTCGCCGTATCATTAAAAAAAAAAGGGGGG	<AAAAFFFFFFFFFF<FFFFFFFF<)F)FAFFFFF)FF<FFFAAF)FAFFFAF7FFAFF7.FFFFF7.F7)7.FFFF<.FF))).7A<FF.FFAFF.FAF<.FF<F7FFF<FFF)<).A<.FF7.FF.FAFFAFF7FFF<FFFAF..<F.F	XA:Z:chr19,+4511702,65M86S,2;chr19,+4512494,65M86S,2;	ZC:i:2	MD:Z:44T20	PG:Z:MarkDuplicates	RG:Z:c7f04110-95d0-4a70-8fa4-4fa000ae74e3	NM:i:1	AS:i:60	XS:i:55");
//			ps.println("NS500239:41:H2HW7BGXX:3:23411:14389:13640	163	chr19	4511306	60	45M	=	4511306	45	GACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACT	AAAAAFFFFFFFFFFFFFFFFFFFA7F7FAFFFFF)FF.FFFAF7	XA:Z:chr19,+4512494,45M,2;	ZC:i:3	MD:Z:45	PG:Z:MarkDuplicates	RG:Z:88f8f4c2-7fff-4248-a79b-66ca71b90d09	NM:i:0	AS:i:45	XS:i:39");
//			ps.println("NS500239:3:H0PLWAGXX:1:12306:24828:13828	147	chr19	4511306	60	119M	=	4511306	-119	GACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTACCTGTTGCGATATTTTGGGTCGTTTTCAGCCC	FFAFFFFAFFFFFFFFFFAFAFFFF<FFFFFFFAFFFFF<FFFFFFFFFFFFFFFFFFAFFFFFFFFFFFF.FFAFFFA.FFFFFFFFFFFFFFFFFFFFFFFFAFFFFAFFFFAAAAA	ZC:i:6	MD:Z:44T74	PG:Z:MarkDuplicates	RG:Z:93ffe214-4381-4767-a36f-b17d0999f87b	NM:i:1	AS:i:114	XS:i:60");
//			ps.println("NS500239:41:H2HW7BGXX:1:11310:20819:4441	147	chr19	4511306	49	70M	=	4511306	-70	GACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGC	FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFFFFFFFFFFFFFFFFFFAAAAA	XA:Z:chr19,-4511702,70M,2;chr19,-4512494,70M,2;	ZC:i:2	MD:Z:44T25	PG:Z:MarkDuplicates	RG:Z:c7f04110-95d0-4a70-8fa4-4fa000ae74e3	NM:i:1	AS:i:65	XS:i:60");
//			ps.println("NS500239:41:H2HW7BGXX:1:23203:10315:4920	83	chr19	4511306	50	65M	=	4511306	-65	GACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCC	FFFFFFFFFFFF<FFFFFFFFFFFFFFFFFFFFFFFFFFFFFAFFFFFFFFFFFFFFFFFAAAAA	XA:Z:chr19,-4511702,65M,2;chr19,-4512494,65M,2;	ZC:i:2	MD:Z:44T20	PG:Z:MarkDuplicates	RG:Z:c7f04110-95d0-4a70-8fa4-4fa000ae74e3	NM:i:1	AS:i:60	XS:i:55");
//			ps.println("NS500239:41:H2HW7BGXX:3:23411:14389:13640	83	chr19	4511306	60	45M	=	4511306	-45	GACTTTGTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACT	FFFFFFFFFF.FAFFFFFFFFFFF7<FFFFFFFFFFFFFFAAAAA	XA:Z:chr19,-4512494,44M1S,1;	ZC:i:3	MD:Z:45	PG:Z:MarkDuplicates	RG:Z:88f8f4c2-7fff-4248-a79b-66ca71b90d09	NM:i:0	AS:i:45	XS:i:39");
//			ps.println("NS500239:3:H0PLWAGXX:3:13612:9316:12508	83	chr19	4511307	43	69M6S	=	4511307	-69	ACTTTGTTGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACTTTCGCAGCACCGGTCACCCCACTGCAGACGG	.FA<AFF))FF.A.F)).FFFFFFFFF.<.FFAFFFF<7FFAFFA<A7AFFFAFFF<AAFFFFFFFFFAFA<AAA	XA:Z:chr19,-4511703,75M,4;chr19,-4512297,75M,5;	ZC:i:7	MD:Z:7A61	PG:Z:MarkDuplicates	RG:Z:cab6d719-bc86-46f3-a80d-a1b1d747b2b8	NM:i:1	AS:i:64	XS:i:55");
//			ps.println("NS500239:3:H0PLWAGXX:1:23312:15509:4901	99	chr19	4511312	60	64M6S	=	4511312	64	GTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACTTTCGCAGCACCGGTCACCCCACTGCAGACGG	AAAAAFFFF)FFF.<FFFFFF)FFFA.FF<AFFF.A)F<FFAFA.FA.)<FFF..AAF<.AFF<FF.AFF	XA:Z:chr19,+4511708,70M,3;chr19,+4512302,70M,4;	ZC:i:6	MD:Z:64	PG:Z:MarkDuplicates	RG:Z:93ffe214-4381-4767-a36f-b17d0999f87b	NM:i:0	AS:i:64	XS:i:55");
//			ps.println("NS500239:41:H2HW7BGXX:1:11208:21382:1810	99	chr19	4511312	43	57M	=	4511312	57	GTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACC	AAAAAFFAF)FFF7FFFF<FF)FFFA<<F)FFFF.F.F<AF<FF<FA.FFAF..)FF	XA:Z:chr19,+4512500,57M,2;chr19,+4511708,57M,2;	ZC:i:2	MD:Z:38T18	PG:Z:MarkDuplicates	RG:Z:c7f04110-95d0-4a70-8fa4-4fa000ae74e3	NM:i:1	AS:i:52	XS:i:48");
//			ps.println("NS500239:3:H0PLWAGXX:1:23312:15509:4901	147	chr19	4511312	60	64M6S	=	4511312	-64	GTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACTTTCGCAGCACCGGTCACCCCACTGCAGACGG	FFFFFF)FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF.FFFFFFFFFFFFAAAA<	XA:Z:chr19,-4511708,70M,3;chr19,-4512302,70M,4;	ZC:i:6	MD:Z:64	PG:Z:MarkDuplicates	RG:Z:93ffe214-4381-4767-a36f-b17d0999f87b	NM:i:0	AS:i:64	XS:i:55");
//			ps.println("NS500239:41:H2HW7BGXX:1:11208:21382:1810	147	chr19	4511312	43	57M	=	4511312	-57	GTAGTGTCCAGGCCCCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACC	FAFFAF<FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7AAA<	XA:Z:chr19,-4512500,57M,2;chr19,-4511708,57M,2;	ZC:i:2	MD:Z:38T18	PG:Z:MarkDuplicates	RG:Z:c7f04110-95d0-4a70-8fa4-4fa000ae74e3	NM:i:1	AS:i:52	XS:i:48");
//			ps.println("NS500239:41:H2HW7BGXX:3:22405:16529:17823	83	chr19	4511326	43	52M4S	=	4511330	-48	CCCCTGGACGGCCCCTTTGGCCACATTCGCAGCACCTGTCACCCCACTGCCATGTG	F.FFF)F7)7A.A.FFFA.AFFFA.FF.AAFF.A)F)AFF....<FAAF.<A.))A	XA:Z:chr19,-4512514,50M6S,3;chr19,-4511527,3S47M6S,2;chr19,-4511722,50M6S,3;	ZC:i:3	MD:Z:24T11G15	PG:Z:MarkDuplicates	RG:Z:88f8f4c2-7fff-4248-a79b-66ca71b90d09	NM:i:2	AS:i:42	XS:i:39");
//			ps.println("NS500239:3:H0PLWAGXX:2:13211:24117:20380	99	chr19	4511331	50	51M	=	4511331	51	GGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGG	AA.AAFFAFFFFFFFFFFFFFFFFFFFFAFFFFFFFFFFFFFFFFFFAFFF	XA:Z:chr19,+4511727,45M6S,1;chr19,+4512519,45M6S,1;chr19,+4511529,45M6S,1;	ZC:i:0	MD:Z:19T31	PG:Z:MarkDuplicates	RG:Z:4605536e-3e37-4b15-b236-699c54c05da8	NM:i:1	AS:i:46	XS:i:41");
//			ps.println("NS500239:3:H0PLWAGXX:2:13211:24117:20380	147	chr19	4511331	50	51M	=	4511331	-51	GGACGGCCCCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGG	FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFFFAFFFAAAAA	XA:Z:chr19,-4511727,45M6S,1;chr19,-4512519,45M6S,1;chr19,-4511529,45M6S,1;	ZC:i:0	MD:Z:19T31	PG:Z:MarkDuplicates	RG:Z:4605536e-3e37-4b15-b236-699c54c05da8	NM:i:1	AS:i:46	XS:i:41");
//			ps.println("NS500239:3:H0PLWAGXX:1:22302:13302:7408	163	chr19	4511339	60	103M	=	4511339	103	CCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTACCTGTTGCGATATTTTGGGTCGTTTTCAGCCCAGTTTGCACAGCACCCT	AAAAAFFFFFFFFFFFFAFFFFFFFFF.FFFFAFFFFFFFFFFFFFFFFFFFF<FFFFFFFFFFFFFFFFFFFFFFFFFFFFAFFFFFFFFFFFFF<F.FFFF	ZC:i:6	MD:Z:11T91	PG:Z:MarkDuplicates	RG:Z:93ffe214-4381-4767-a36f-b17d0999f87b	NM:i:1	AS:i:98	XS:i:41");
//			ps.println("NS500239:3:H0PLWAGXX:1:22302:13302:7408	83	chr19	4511339	60	103M	=	4511339	-103	CCTTTGGCCACATTCGCAGCACCGGTCACCCCACTGCCAAGGGTGTTCTTTGTACCTGTTGCGATATTTTGGGTCGTTTTCAGCCCAGTTTGCACAGCACCCT	FFFFFFFFF<FAF7FFF<AFFFFAF<FFFFFFFF<FFF)7FFF.FAAFFFFFFFFFAFF<FFFFFFFFFFFFFAFFFAFFF<FFFFFFF.FFFFFFFFAAAAA	ZC:i:6	MD:Z:11T91	PG:Z:MarkDuplicates	RG:Z:93ffe214-4381-4767-a36f-b17d0999f87b	NM:i:1	AS:i:98	XS:i:41");
//		}
//		
//		SamReader reader = SamReaderFactory.makeDefault().open(file);
//		SAMRecordIterator iter = reader.iterator();
//		return iter.stream().collect(Collectors.toList());
//		
//	}
	
	private static SAMRecord createSamRec(String s, SAMFileHeader header) {
		/*
		 * convert to string array
		 */
		String [] array = TabTokenizer.tokenize(s, Constants.TAB);
		SAMRecord rec = new SAMRecord(header);
		rec.setReadName(array[0]);
		rec.setFlags(Integer.parseInt(array[1]));
		rec.setReferenceName(array[2]);
		rec.setAlignmentStart(Integer.parseInt(array[3]));
		rec.setMappingQuality(Integer.parseInt(array[4]));
		rec.setCigarString(array[5]);
		rec.setMateReferenceName(array[6]);
		rec.setInferredInsertSize(Integer.parseInt(array[8]));
		rec.setReadString(array[9]);
		rec.setBaseQualityString(array[10]);
		
		return rec;
	}
	
	
	
}
